{"code":"!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"/static/\",n(n.s=10)}([function(t,e,n){\"use strict\";var i,o=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},r=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),s=[];function a(t){for(var e=-1,n=0;n<s.length;n++)if(s[n].identifier===t){e=n;break}return e}function l(t,e){for(var n={},i=[],o=0;o<t.length;o++){var r=t[o],l=e.base?r[0]+e.base:r[0],c=n[l]||0,h=\"\".concat(l,\" \").concat(c);n[l]=c+1;var u=a(h),d={css:r[1],media:r[2],sourceMap:r[3]};-1!==u?(s[u].references++,s[u].updater(d)):s.push({identifier:h,updater:m(d,e),references:1}),i.push(h)}return i}function c(t){var e=document.createElement(\"style\"),i=t.attributes||{};if(void 0===i.nonce){var o=n.nc;o&&(i.nonce=o)}if(Object.keys(i).forEach((function(t){e.setAttribute(t,i[t])})),\"function\"==typeof t.insert)t.insert(e);else{var s=r(t.insert||\"head\");if(!s)throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");s.appendChild(e)}return e}var h,u=(h=[],function(t,e){return h[t]=e,h.filter(Boolean).join(\"\\n\")});function d(t,e,n,i){var o=n?\"\":i.media?\"@media \".concat(i.media,\" {\").concat(i.css,\"}\"):i.css;if(t.styleSheet)t.styleSheet.cssText=u(e,o);else{var r=document.createTextNode(o),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(r,s[e]):t.appendChild(r)}}function p(t,e,n){var i=n.css,o=n.media,r=n.sourceMap;if(o?t.setAttribute(\"media\",o):t.removeAttribute(\"media\"),r&&btoa&&(i+=\"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r)))),\" */\")),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var f=null,v=0;function m(t,e){var n,i,o;if(e.singleton){var r=v++;n=f||(f=c(e)),i=d.bind(null,n,r,!1),o=d.bind(null,n,r,!0)}else n=c(e),i=p.bind(null,n,e),o=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else o()}}t.exports=function(t,e){(e=e||{}).singleton||\"boolean\"==typeof e.singleton||(e.singleton=o());var n=l(t=t||[],e);return function(t){if(t=t||[],\"[object Array]\"===Object.prototype.toString.call(t)){for(var i=0;i<n.length;i++){var o=a(n[i]);s[o].references--}for(var r=l(t,e),c=0;c<n.length;c++){var h=a(n[c]);0===s[h].references&&(s[h].updater(),s.splice(h,1))}n=r}}}},function(t,e,n){\"use strict\";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||\"\",i=t[3];if(!i)return n;if(e&&\"function\"==typeof btoa){var o=(s=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),l=\"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(a),\"/*# \".concat(l,\" */\")),r=i.sources.map((function(t){return\"/*# sourceURL=\".concat(i.sourceRoot||\"\").concat(t,\" */\")}));return[n].concat(r).concat([o]).join(\"\\n\")}var s,a,l;return[n].join(\"\\n\")}(e,t);return e[2]?\"@media \".concat(e[2],\" {\").concat(n,\"}\"):n})).join(\"\")},e.i=function(t,n,i){\"string\"==typeof t&&(t=[[null,t,\"\"]]);var o={};if(i)for(var r=0;r<this.length;r++){var s=this[r][0];null!=s&&(o[s]=!0)}for(var a=0;a<t.length;a++){var l=[].concat(t[a]);i&&o[l[0]]||(n&&(l[2]?l[2]=\"\".concat(n,\" and \").concat(l[2]):l[2]=n),e.push(l))}},e}},function(t,e,n){var i;i=\"undefined\"!=typeof window?window:this,t.exports=function(){\"use strict\";var t=this,e=t.document,n=function t(){return t.world.apply(t,arguments)};n.util={},(n.aabb=function(t,e,n,i){var o={x:0,y:0,hw:0,hh:0};return void 0===t?o:(t&&void 0!==t.x&&(n=e.x,i=e.y,e=t.y,t=t.x),void 0===i&&void 0!==t&&void 0!==e?(o.hw=.5*t,o.hh=.5*e,n&&void 0!==n.x&&(o.x=n.x,o.y=n.y),o):(o.hw=.5*Math.abs(n-t),o.hh=.5*Math.abs(i-e),o.x=.5*(n+t),o.y=.5*(i+e),o))}).contains=function(t,e){return e.x>t.x-t.hw&&e.x<t.x+t.hw&&e.y>t.y-t.hh&&e.y<t.y+t.hh},n.aabb.clone=function(t){return{x:t.x,y:t.y,hw:t.hw,hh:t.hh}},n.aabb.union=function(t,e,n){var i=!0===n?t:{},o=Math.max(t.x+t.hw,e.x+e.hw),r=Math.max(t.y+t.hh,e.y+e.hh),s=Math.min(t.x-t.hw,e.x-e.hw),a=Math.min(t.y-t.hh,e.y-e.hh);return i.hw=.5*Math.abs(o-s),i.hh=.5*Math.abs(r-a),i.x=.5*(o+s),i.y=.5*(r+a),i},n.aabb.overlap=function(t,e){var n=t.x-t.hw,i=e.x-e.hw,o=t.x+t.hw,r=e.x+e.hw;return(o>=i&&r>=o||r>=n&&o>=r)&&(n=t.y-t.hh,i=e.y-e.hh,o=t.y+t.hh,r=e.y+e.hh,o>=i&&r>=o||r>=n&&o>=r)},function(){var t=function(t,e,n){var i=e.normSq()-e.dot(t),o=e.dot(t)-t.normSq();return 0>i?n.clone(e).negate():o>0?n.clone(t).negate():(n.clone(e).vsub(t),n.perp(t.cross(n)>0))};n.gjk=function(e,i,o,r){var s,a,l,c,h=!1,u=!1,d=!1,p=[],f=1,v=n.scratchpad(),m=v.vector().clone(i||n.vector.axis[0]),g=v.vector(),y=v.vector(),b=v.vector(),_=v.vector(),w=0;for(c=e(m),f=p.push(c),g.clone(c.pt),m.negate();++w;){if(g.swap(y),c=e(m),f=p.push(c),g.clone(c.pt),r&&r(p),g.equals(n.vector.zero)){h=!0;break}if(!u&&g.dot(m)<=0){if(o)break;u=!0}if(2===f)m=t(g,y,m);else if(u){if(m.normalize(),c=y.dot(m),Math.abs(c-g.dot(m))<1e-4){d=-c;break}y.normSq()<b.clone(p[0].pt).normSq()?p.shift():p.splice(1,1),m=t(b.clone(p[1].pt),_.clone(p[0].pt),m)}else if(s=s||v.vector(),a=a||v.vector(),s.clone(y).vsub(g),a.clone(p[0].pt).vsub(g),(l=s.cross(a)>0)^g.cross(s)>0)p.shift(),s.perp(!l),m.swap(s);else{if(!(l^a.cross(g)>0)){h=!0;break}p.splice(1,1),a.perp(l),m.swap(s)}if(w>100)return v.done(),{simplex:p,iterations:w,distance:0,maxIterationsReached:!0}}return v.done(),c={overlap:h,simplex:p,iterations:w},!1!==d&&(c.distance=d,c.closest=function(t){var e,i,o=t.length,r=t[o-2],s=t[o-3],a=n.scratchpad(),l=a.vector().clone(r.pt),c=a.vector().clone(s.pt).vsub(l);return c.equals(n.vector.zero)?a.done({a:r.a,b:r.b}):(i=1-(e=-c.dot(l)/c.normSq()),a.done(0>=i?{a:s.a,b:s.b}:0>=e?{a:r.a,b:r.b}:{a:l.clone(r.a).mult(i).vadd(c.clone(s.a).mult(e)).values(),b:l.clone(r.b).mult(i).vadd(c.clone(s.b).mult(e)).values()}))}(p)),c}}(),n.statistics={pushRunningAvg:function(t,e,n,i){var o=t-n;return[n+=o/e,i+=o*(t-n)]},pushRunningVectorAvg:function(t,e,n,i){var o=1/e,r=t.get(0)-n.get(0),s=t.get(1)-n.get(1);n.add(r*o,s*o),i&&(r*=t.get(0)-n.get(0),s*=t.get(1)-n.get(1),i.add(r,s))}},function(){var t=function t(e,i,o){return this instanceof t?(this.v=new n.vector,this.o=new n.vector,e instanceof t?void this.clone(e):(e&&this.setTranslation(e),void this.setRotation(i||0,o))):new t(e,i)};t.prototype.setTranslation=function(t){return this.v.clone(t),this},t.prototype.setRotation=function(t,e){return this.cosA=Math.cos(t),this.sinA=Math.sin(t),e?this.o.clone(e):this.o.zero(),this},t.prototype.clone=function(e){return e?(this.setTranslation(e.v),this.cosA=e.cosA,this.sinA=e.sinA,this.o.clone(e.o),this):new t(this)},n.transform=t}(),function(t){var e=Math.sqrt,i=Math.min,o=Math.max,r=(Math.acos,Math.atan2),s=2*Math.PI,a=!!t.Float64Array,l=function t(e,n){return this instanceof t?(this._=a?new Float64Array(5):[],void(e&&(void 0!==e.x||e._&&e._.length)?this.clone(e):(this.recalc=!0,this.set(e,n)))):new t(e,n)};Object.defineProperties(l.prototype,{x:{get:function(){return+this._[0]},set:function(t){t=+t||0,this.recalc=t===this._[0],this._[0]=t}},y:{get:function(){return+this._[1]},set:function(t){t=+t||0,this.recalc=t===this._[1],this._[1]=t}}}),l.prototype.set=function(t,e){return this.recalc=!0,this._[0]=+t||0,this._[1]=+e||0,this},l.prototype.get=function(t){return this._[t]},l.prototype.vadd=function(t){return this.recalc=!0,this._[0]+=t._[0],this._[1]+=t._[1],this},l.prototype.vsub=function(t){return this.recalc=!0,this._[0]-=t._[0],this._[1]-=t._[1],this},l.prototype.add=function(t,e){return this.recalc=!0,this._[0]+=+t||0,this._[1]+=+e||0,this},l.prototype.sub=function(t,e){return this.recalc=!0,this._[0]-=t,this._[1]-=void 0===e?0:e,this},l.prototype.mult=function(t){return this.recalc||(this._[4]*=t*t,this._[3]*=t),this._[0]*=t,this._[1]*=t,this},l.prototype.dot=function(t){return this._[0]*t._[0]+this._[1]*t._[1]},l.prototype.cross=function(t){return-this._[0]*t._[1]+this._[1]*t._[0]},l.prototype.proj=function(t){return this.dot(t)/t.norm()},l.prototype.vproj=function(t){var e=this.dot(t)/t.normSq();return this.clone(t).mult(e)},l.prototype.angle=function(t){var e;if(this.equals(l.zero))return t?t.angle():NaN;for(e=t&&!t.equals(l.zero)?r(this._[1]*t._[0]-this._[0]*t._[1],this._[0]*t._[0]+this._[1]*t._[1]):r(this._[1],this._[0]);e>Math.PI;)e-=s;for(;e<-Math.PI;)e+=s;return e},l.prototype.angle2=function(t,e){for(var n=t._[0]-this._[0],i=t._[1]-this._[1],o=e._[0]-this._[0],a=e._[1]-this._[1],l=r(i*o-n*a,n*o+i*a);l>Math.PI;)l-=s;for(;l<-Math.PI;)l+=s;return l},l.prototype.norm=function(){return this.recalc&&(this.recalc=!1,this._[4]=this._[0]*this._[0]+this._[1]*this._[1],this._[3]=e(this._[4])),this._[3]},l.prototype.normSq=function(){return this.recalc&&(this.recalc=!1,this._[4]=this._[0]*this._[0]+this._[1]*this._[1],this._[3]=e(this._[4])),this._[4]},l.prototype.dist=function(t){var n,i;return e((n=t._[0]-this._[0])*n+(i=t._[1]-this._[1])*i)},l.prototype.distSq=function(t){var e,n;return(e=t._[0]-this._[0])*e+(n=t._[1]-this._[1])*n},l.prototype.perp=function(t){var e=this._[0];return t?(this._[0]=this._[1],this._[1]=-e):(this._[0]=-this._[1],this._[1]=e),this},l.prototype.normalize=function(){var t=this.norm();return 0===t||(t=1/t,this._[0]*=t,this._[1]*=t,this._[3]=1,this._[4]=1),this},l.prototype.transform=function(t){var e=t.sinA,n=t.cosA,i=t.o._[0],o=t.o._[1];return this._[0]-=i,this._[1]-=o,this.set(this._[0]*n-this._[1]*e+i+t.v._[0],this._[0]*e+this._[1]*n+o+t.v._[1])},l.prototype.transformInv=function(t){var e=t.sinA,n=t.cosA,i=t.o._[0],o=t.o._[1];return this._[0]-=i+t.v._[0],this._[1]-=o+t.v._[1],this.set(this._[0]*n+this._[1]*e+i,-this._[0]*e+this._[1]*n+o)},l.prototype.rotate=function(t,e){var n,i,o=0,r=0;return\"number\"==typeof t?(n=Math.sin(t),i=Math.cos(t),e&&(o=e.x,r=e.y)):(n=t.sinA,i=t.cosA,o=t.o._[0],r=t.o._[1]),this._[0]-=o,this._[1]-=r,this.set(this._[0]*i-this._[1]*n+o,this._[0]*n+this._[1]*i+r)},l.prototype.rotateInv=function(t){return this.set((this._[0]-t.o._[0])*t.cosA+(this._[1]-t.o._[1])*t.sinA+t.o._[0],-(this._[0]-t.o._[0])*t.sinA+(this._[1]-t.o._[1])*t.cosA+t.o._[1])},l.prototype.translate=function(t){return this.vadd(t.v)},l.prototype.translateInv=function(t){return this.vsub(t.v)},l.prototype.clone=function(t){return t?t._?(this.recalc=t.recalc,t.recalc||(this._[3]=t._[3],this._[4]=t._[4]),this._[0]=t._[0],this._[1]=t._[1],this):this.set(t.x,t.y):new l(this)},l.prototype.swap=function(t){var e=this._;return this._=t._,t._=e,e=this.recalc,this.recalc=t.recalc,t.recalc=e,this},l.prototype.values=function(){return{x:this._[0],y:this._[1]}},l.prototype.zero=function(){return this._[3]=0,this._[4]=0,this._[0]=0,this._[1]=0,this},l.prototype.negate=function(t){return void 0!==t?(this._[t]=-this._[t],this):(this._[0]=-this._[0],this._[1]=-this._[1],this)},l.prototype.clamp=function(t,e){return this._[0]=i(o(this._[0],t.x),e.x),this._[1]=i(o(this._[1],t.y),e.y),this.recalc=!0,this},l.prototype.toString=function(){return\"(\"+this._[0]+\", \"+this._[1]+\")\"},l.prototype.equals=function(t){return this._[0]===t._[0]&&this._[1]===t._[1]&&this._[2]===t._[2]},l.axis=[new l(1,0),new l(0,1)],l.zero=new l(0,0),n.vector=l}(this),function(t){var e=t.Physics;n.noConflict=function(){return t.Physics===n&&(t.Physics=e),n}}(this);var i=n.util.decorator=function(t,e){var i={},o={},r=function(t,e){var i,o;for(o in e)(i=Object.getOwnPropertyDescriptor(e,o)).get||i.set?Object.defineProperty(t,o,i):n.util.isFunction(i.value)&&(t[o]=i.value);return t},s=Object.getPrototypeOf;\"function\"!=typeof s&&(s=\"object\"==typeof\"test\".__proto__?function(t){return t.__proto__}:function(t){return t.constructor.prototype});var a=Object.create;\"function\"!=typeof a&&(a=function(t){function e(){}return e.prototype=t,new e});var l=function(e,i){return\"object\"==typeof e?void((o=r(o,e)).type=t):void(\"type\"!==e&&n.util.isFunction(i)&&(o[e]=i))};l(e);var c=function(e,n,l,c){var h,u=o;if(\"string\"!=typeof n)c=l,l=n;else{if(!(u=i[n]))throw'Error: \"'+n+'\" '+t+\" not defined\";u=u.prototype}if(\"function\"==typeof l)(h=i[e])?h.prototype=r(h.prototype,l(s(h.prototype))):((h=i[e]=function(t){this.init&&this.init(t)}).prototype=a(u),h.prototype=r(h.prototype,l(u,h.prototype))),h.prototype.type=t,h.prototype.name=e;else if(c=l||{},!(h=i[e]))throw'Error: \"'+e+'\" '+t+\" not defined\";return c?new h(c):void 0};return c.mixin=l,c};n.util.indexOf=function(t,e){for(var n=0,i=t.length;i>n;){if(i--,t[n]===e)return n;if(t[i]===e)return i;n++}return-1},n.util.clearArray=function(t){for(var e=t.length;e--;)t.pop();return t},n.util.throttle=function(t,e,n){var i,o,r=!1,s=function(){clearTimeout(i),r?(r=!1,i=setTimeout(s,e),t.apply(n,o)):i=!1};return n=n||null,function(){r=!0,o=arguments,i||s()}};var o=function(t,e){return n.util.isPlainObject(e)?n.util.extend({},t,e,o):void 0!==e?e:t};return n.util.options=function(t,e){var i,r={},s=[];return(i=function(t,i){n.util.extend(e,t,i?o:null);for(var r=0,a=s.length;a>r;++r)s[r](e);return e}).defaults=function(t,i){return n.util.extend(r,t,i?o:null),n.util.defaults(e,r,i?o:null),r},i.onChange=function(t){s.push(t)},e=e||i,i.defaults(t),i},n.util.pairHash=function(t,e){return(0|(t|=0))==(0|(e|=0))?-1:0|((0|t)>(0|e)?t<<16|65535&e:e<<16|65535&t)},n.util.bind=Function.prototype.bind?function(t,e,n){return n=Array.prototype.slice.call(arguments,1),Function.prototype.bind.apply(t,n)}:function(t,e,n){return n=Array.prototype.slice.call(arguments,2),function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}},n.util.find=function(t,e){var n,i,o=t.length;for(n=0;o>n;n++)if(e(i=t[n],n,t))return i},n.util.filter=function(t,e){var n,i,o=t.length,r=[];for(n=0;o>n;n++)e(i=t[n],n,t)&&r.push(i);return r},function(){function t(t){n.util.clearArray(t),g.length<b&&g.push(t)}function e(){return y.pop()||{array:null,cache:null,criteria:null,false:!1,index:0,null:!1,number:null,object:null,push:null,string:null,true:!1,undefined:!1,value:null}}function i(t,e){var i=typeof e;if(t=t.cache,\"boolean\"===i||null==e)return t[e]?0:-1;\"number\"!==i&&\"string\"!==i&&(i=\"object\");var o=\"number\"===i?e:_+e;return t=(t=t[i])&&t[o],\"object\"===i?t&&n.util.indexOf(t,e)>-1?0:-1:t?0:-1}function o(t){var e=this.cache,n=typeof t;if(\"boolean\"===n||null==t)e[t]=!0;else{\"number\"!==n&&\"string\"!==n&&(n=\"object\");var i=\"number\"===n?t:_+t,o=e[n]||(e[n]={});\"object\"===n?(o[i]||(o[i]=[])).push(t):o[i]=!0}}function r(t){var n=-1,i=t.length,r=t[0],s=t[i/2|0],a=t[i-1];if(r&&\"object\"==typeof r&&s&&\"object\"==typeof s&&a&&\"object\"==typeof a)return!1;var l=e();l.false=l.null=l.true=l.undefined=!1;var c=e();for(c.array=t,c.cache=l,c.push=o;++n<i;)c.push(t[n]);return c}function s(t,e){return t+Math.floor(Math.random()*(e-t+1))}function a(t){return\"function\"==typeof t}function l(t){var e,n;if(!t||f.call(t)!==d||a(e=t.constructor)&&!(e instanceof e))return!1;for(var i in t)n=i;return void 0===n||v.call(t,n)}function c(e,o,s){var a=-1,l=n.util.indexOf,c=e?e.length:0,h=[],u=!o&&c>=m&&l===n.util.indexOf,d=s||u?g.pop()||[]:h;for(u&&(l=i,d=r(d));++a<c;){var p=e[a],f=s?s(p,a,e):p;(o?!a||d[d.length-1]!==f:l(d,f)<0)&&((s||u)&&d.push(f),h.push(p))}return u?(t(d.array),function t(e){var n=e.cache;n&&t(n),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,y.length<b&&y.push(e)}(d)):s&&t(d),h}var h={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},u=function(t){return t},d=\"[object Object]\",p=Object.keys,f=Object.prototype.toString,v=Object.prototype.hasOwnProperty,m=75,g=[],y=[],b=40,_=+new Date+\"\",w=p?function(t){return n.util.isObject(t)?p(t):[]}:function(t){var e,n=t,i=[];if(!n)return i;if(!h[typeof t])return i;for(e in n)v.call(n,e)&&i.push(e);return i},x=0;n.util.uniqueId=function(t){return\"\"+(t||\"\")+ ++x},n.util.shuffle=function(t){var e,n,i,o,r=-1,a=t?t.length:0,l=Array(\"number\"==typeof a?a:0);for(e=0,n=t.length;n>e;e++)i=t[e],o=s(0,++r),l[r]=l[o],l[o]=i;return l},n.util.isObject=function(t){return!(!t||!h[typeof t])},n.util.isFunction=a,n.util.isArray=Array.isArray||function(t){return t&&\"object\"==typeof t&&\"number\"==typeof t.length&&\"[object Array]\"===f.call(t)||!1};var P=RegExp(\"^\"+String(f).replace(/[.*+?^${}()|[\\]\\\\]/g,\"\\\\$&\").replace(/toString| for [^\\]]+/g,\".*?\")+\"$\");n.util.isPlainObject=Object.getPrototypeOf?function(t){if(!t||f.call(t)!==d)return!1;var e=t.valueOf,n=function(t){return\"function\"==typeof t&&P.test(t)}(e)&&(n=Object.getPrototypeOf(e))&&Object.getPrototypeOf(n);return n?t===n||Object.getPrototypeOf(t)===n:l(t)}:l,n.util.uniq=function(t,e,n){return\"boolean\"!=typeof e&&null!=e&&(n=e,e=!1),c(t,e,n)},n.util.extend=function(t,e,n){var i,o=t,r=o;if(!o)return r;var s,a=arguments,l=0,c=\"number\"==typeof n?2:a.length;for(c>2&&\"function\"==typeof a[c-1]&&(s=a[--c]);++l<c;)if((o=a[l])&&h[typeof o])for(var u=-1,d=h[typeof o]&&w(o),p=d?d.length:0;++u<p;)r[i=d[u]]=s?s(r[i],o[i]):o[i];return r},n.util.defaults=function(t,e,n){var i,o=t,r=o;if(!o)return r;for(var s=arguments,a=0,l=\"number\"==typeof n?2:s.length;++a<l;)if((o=s[a])&&h[typeof o])for(var c=-1,u=h[typeof o]&&w(o),d=u?u.length:0;++c<d;)void 0===r[i=u[c]]&&(r[i]=o[i]);return r},n.util.sortedIndex=function(t,e,n){var i=0,o=t?t.length:i;for(e=(n=n||u)(e);o>i;){var r=i+o>>>1;n(t[r])<e?i=r+1:o=r}return i}}(),n.scratchpad=function(){var t,e,i=[],o=0,r=0;return(t=function(){if(this._active=!1,this._indexArr=[],++o>=e.maxScratches)throw\"Error: Too many scratchpads created. (Did you forget to call .done()?)\"}).prototype={done:function(t){this._active=!1;for(var e=0;r>e;++e)this[e]=0;return i.push(this),t}},(e=function e(n){if(n)return e.fn(n);var o=i.pop()||new t;return o._active=!0,o}).maxScratches=100,e.maxIndex=20,e.fn=function(e){for(var n=[],o=0,r=e.length;r>o;o++)n.push(o);return n=\"a\"+n.join(\",a\"),new Function(\"fn, scratches, Scratch\",\"return function(\"+n+\"){ var scratch = scratches.pop() || new Scratch( scratches );scratch._active = true;return scratch.done( fn(scratch, \"+n+\") );};\")(e,i,t)},e.register=function(n,i,o){var s=t.prototype,a=r++,l=\"_\"+n+\"Stack\",c=o&&o.useFactory;if(n in s)throw\"Error: Object is already registered.\";t.prototype[n]=function(){var t=this[l]||(this[l]=[]),n=0|this[a];if(this[a]=n+1,!this._active)throw\"Error: Scratchpad used after .done() called. (Could it be unintentionally scoped?)\";if(n>=e.maxIndex)throw\"Error: Scratchpad usage space out of bounds. (Did you forget to call .done()?)\";return t[n]||(t[n]=c?i():new i)}},e.register(\"vector\",n.vector),e.register(\"transform\",n.transform),e}(),function(){function t(t){return t._priority_}n.scratchpad.register(\"event\",(function(){return{}}),{useFactory:!0});var e=function t(){return this instanceof t?void 0:new t};e.prototype={on:function(e,i,o,r){var s,a,l;if(this._topics=this._topics||(this._topics={}),n.util.isObject(e)){for(var c in e)this.on(c,e[c],i,o);return this}return s=this._topics[e]||(this._topics[e]=[]),a=i,n.util.isObject(o)?((i=n.util.bind(i,o))._bindfn_=a,i._one_=a._one_,i._scope_=o):void 0===r&&(r=o),i._priority_=void 0===r?1:r,l=n.util.sortedIndex(s,i,t),s.splice(l,0,i),this},off:function(t,e,i){var o,r;if(!this._topics)return this;if(!0===t)return this._topics={},this;if(n.util.isObject(t)){for(var s in t)this.off(s,t[s]);return this}if(!(o=this._topics[t]))return this;if(!0===e)return this._topics[t]=[],this;for(var a=0,l=o.length;l>a;a++)if(!((r=o[a])._bindfn_!==e&&r!==e||i&&r._scope_!==i)){o.splice(a,1);break}return this},emit:function(t,e){if(!this._topics)return this;var i,o,r=this._topics[t],s=r&&r.length,a=n.scratchpad();if(!s)return a.done(this);for((o=a.event()).topic=t,o.handler=i;s--;)(i=r[s])(e,o),i._one_&&r.splice(s,1);return a.done(this)},one:function(t,e,i){if(n.util.isObject(t)){for(var o in t)this.one(o,t[o],e,i);return this}return e._one_=!0,this.on(t,e,i),this}},n.util.pubsub=e}(),function(t){function e(){return r&&r.now?r.now()+r.timing.navigationStart:Date.now()}var i=!0,o=n.util.pubsub(),r=t.performance;t.requestAnimationFrame?function n(){var r;t.requestAnimationFrame(n),i&&(r=e())&&o.emit(\"tick\",r)}():i=!1,n.util.ticker={now:e,start:function(){return i=!0,this},stop:function(){return i=!1,this},on:function(t){return o.on(\"tick\",t),this},off:function(t){return o.off(\"tick\",t),this},isActive:function(){return!!i}}}(this),function(){var t=function(){return!0},e=n.util.indexOf,i=function(t,e){return function(n){return t(n[e])}},o=function(t,i){return function(o){o=i?o[i]:o;var r,s=0;if(n.util.isArray(o)){if(n.util.isArray(t)){if((r=o.length)!==t.length)return!1;for(;r>s;){if(r--,-1===e(t,o[s])||-1===e(t,o[r]))return!1;s++}return!0}return e(o,t)>-1}return o===t}},r=function(t,i){return function(o){o=i?o[i]:o;var r,s=0;if(n.util.isArray(o)){for(r=o.length;r>s;){if(r--,e(t,o[s])>-1||e(t,o[r])>-1)return!0;s++}return!1}return e(t,o)>-1}},s=function(t){return t.next?function(e){for(var n=t;n;){if(!n(e))return!1;n=n.next}return!0}:t},a={$eq:o,$ne:function(t,e){var n=o(t,e);return function(t){return!n(t)}},$in:r,$nin:function(t,e){var n=r(t,e);return function(t){return!n(t)}},$at:function(t){return t=new n.vector(t),function(e){var i=e.aabb();return n.aabb.contains(i,t)}}};n.query=function e(r,l){var c,h,u,d,p,f;if(l){if(\"$or\"===l||\"$and\"===l){for(c=0,h=r.length;h>c;++c)f=e(r[c]),p=p?p.next=f:d=f;return\"$or\"===l?function(t){return t.next?function(e){for(var n=t;n;){if(n(e))return!0;n=n.next}return!1}:t}(d):s(d)}if(c=a[l])return c(r);throw\"Unknown query operation: \"+l}for(c in r)u=r[c],f=\"$\"===c[0]?e(u,c):n.util.isPlainObject(u)?i(e(u),c):o(u,c),p=p?p.next=f:d=f;return s(d||t)}}(),function(){var t={priority:0};n.behavior=i(\"behavior\",{init:function(e){this.options=n.util.options(t),this.options(e)},applyTo:function(t){return this._targets=!0===t?null:n.util.uniq(t),this},getTargets:function(){return this._targets||(this._world?this._world._bodies:[])},setWorld:function(t){return this.disconnect&&this._world&&this.disconnect(this._world),this._world=t,this.connect&&t&&this.connect(t),this},connect:function(t){this.behave&&t.on(\"integrate:positions\",this.behave,this,this.options.priority)},disconnect:function(t){this.behave&&t.off(\"integrate:positions\",this.behave,this)},behave:null})}(),function(){var t={hidden:!1,treatment:\"dynamic\",mass:1,restitution:1,cof:.8,view:null},e=1;Math.PI,(n.body=i(\"body\",{init:function(i){var o=this,r=n.vector;if(this.options=n.util.options(t,this),this.options.onChange((function(t){o.offset=new r(t.offset)})),this.options(i),this.state={pos:new r(this.x,this.y),vel:new r(this.vx,this.vy),acc:new r,angular:{pos:this.angle||0,vel:this.angularVelocity||0,acc:0},old:{pos:new r,vel:new r,acc:new r,angular:{pos:0,vel:0,acc:0}}},this._sleepAngPosMean=0,this._sleepAngPosVariance=0,this._sleepPosMean=new r,this._sleepPosVariance=new r,this._sleepMeanK=0,delete this.x,delete this.y,delete this.vx,delete this.vy,delete this.angle,delete this.angularVelocity,0===this.mass)throw\"Error: Bodies must have non-zero mass\";this.uid=e++,this.geometry=n.geometry(\"point\")},sleep:function(t){return!0===t?this.asleep=!0:!1===t?(this.asleep=!1,this._sleepMeanK=0,this._sleepAngPosMean=0,this._sleepAngPosVariance=0,this._sleepPosMean.zero(),this._sleepPosVariance.zero(),this.sleepIdleTime=0):t&&!this.asleep&&this.sleepCheck(t),this.asleep},sleepCheck:function(t){var e=this._world&&this._world.options;if(!(this.sleepDisabled||e&&e.sleepDisabled)){var i,o,r,s,a,l,c=n.scratchpad();if(c.vector(),c.vector(),t=t||0,s=this.geometry.aabb(),r=Math.max(s.hw,s.hh),this.asleep&&(o=this.state.vel.norm()+Math.abs(r*this.state.angular.vel))>=(i=this.sleepSpeedLimit||e&&e.sleepSpeedLimit||0))return this.sleep(!1),c.done();this._sleepMeanK++,a=this._sleepMeanK>1?1/(this._sleepMeanK-1):0,n.statistics.pushRunningVectorAvg(this.state.pos,this._sleepMeanK,this._sleepPosMean,this._sleepPosVariance),l=n.statistics.pushRunningAvg(Math.sin(this.state.angular.pos),this._sleepMeanK,this._sleepAngPosMean,this._sleepAngPosVariance),this._sleepAngPosMean=l[0],this._sleepAngPosVariance=l[1],o=this._sleepPosVariance.norm()+Math.abs(r*Math.asin(l[1])),o*=a,(i=this.sleepVarianceLimit||e&&e.sleepVarianceLimit||0)>=o?(i=this.sleepTimeLimit||e&&e.sleepTimeLimit||0,this.sleepIdleTime=(this.sleepIdleTime||0)+t,this.sleepIdleTime>i&&(this.asleep=!0)):this.sleep(!1),c.done()}},setWorld:function(t){return this.disconnect&&this._world&&this.disconnect(this._world),this._world=t,this.connect&&t&&this.connect(t),this},accelerate:function(t){return\"dynamic\"===this.treatment&&this.state.acc.vadd(t),this},applyForce:function(t,e){if(\"dynamic\"!==this.treatment)return this;var i=n.scratchpad(),o=i.vector();return e&&this.moi&&(this.state,o.clone(e),this.state.angular.acc-=o.cross(t)/this.moi),this.accelerate(o.clone(t).mult(1/this.mass)),i.done(),this},getGlobalOffset:function(t){return(t=t||new n.vector).clone(this.offset).rotate(this.state.angular.pos),t},aabb:function(){var t=this.state.angular.pos,e=n.scratchpad(),i=e.vector(),o=this.geometry.aabb(t);return this.getGlobalOffset(i),o.x+=this.state.pos._[0]+i._[0],o.y+=this.state.pos._[1]+i._[1],e.done(o)},toBodyCoords:function(t){return t.vsub(this.state.pos).rotate(-this.state.angular.pos)},toWorldCoords:function(t){return t.rotate(this.state.angular.pos).vadd(this.state.pos)},recalc:function(){return this}})).getCOM=function(t,e){var i,o,r,s=t&&t.length,a=0;if(e=e||new n.vector,!s)return e.zero();if(1===s)return e.clone(t[0].state.pos);for(e.zero(),r=0;s>r;r++)o=(i=t[r]).state.pos,e.add(o._[0]*i.mass,o._[1]*i.mass),a+=i.mass;return e.mult(1/a),e}}(),(n.geometry=i(\"geometry\",{init:function(t){this.options=n.util.options(),this.options(t),this._aabb=new n.aabb},aabb:function(){return n.aabb.clone(this._aabb)},getFarthestHullPoint:function(t,e){return(e=e||new n.vector).set(0,0)},getFarthestCorePoint:function(t,e){return(e=e||new n.vector).set(0,0)}})).regularPolygonVertices=function(t,e){var n,i=[],o=2*Math.PI/t,r=0;for(n=0;t>n;n++)i.push({x:e*Math.cos(r),y:e*Math.sin(r)}),r+=o;return i},n.geometry.isPolygonConvex=function(t){var e=n.scratchpad(),i=e.vector(),o=e.vector(),r=e.vector(),s=!0,a=!1,l=t.length;if(!t||!l)return!1;if(3>l)return e.done(),s;i.clone(t[0]).vsub(r.clone(t[l-1]));for(var c=1;l>=c;++c){if(o.clone(t[c%l]).vsub(r.clone(t[(c-1)%l])),!1===a)a=i.cross(o);else if(a>0^i.cross(o)>0){s=!1;break}o.swap(i)}return e.done(),s},n.geometry.getPolygonMOI=function(t){var e,i=n.scratchpad(),o=i.vector(),r=i.vector(),s=0,a=0,l=t.length;if(2>l)return i.done(),0;if(2===l)return e=r.clone(t[1]).distSq(o.clone(t[0])),i.done(),e/12;o.clone(t[0]);for(var c=1;l>c;++c)r.clone(t[c]),s+=(e=Math.abs(r.cross(o)))*(r.normSq()+r.dot(o)+o.normSq()),a+=e,o.swap(r);return i.done(),s/(6*a)},n.geometry.isPointInPolygon=function(t,e){var i=n.scratchpad(),o=i.vector().clone(t),r=i.vector(),s=i.vector(),a=0,l=e.length;if(2>l)return a=o.equals(r.clone(e[0])),i.done(),a;if(2===l)return a=o.angle(r.clone(e[0])),a+=o.angle(r.clone(e[1])),i.done(),Math.abs(a)===Math.PI;r.clone(e[0]).vsub(o);for(var c=1;l>=c;++c)s.clone(e[c%l]).vsub(o),a+=s.angle(r),r.swap(s);return i.done(),Math.abs(a)>1e-6},n.geometry.getPolygonArea=function(t){var e=n.scratchpad(),i=e.vector(),o=e.vector(),r=0,s=t.length;if(3>s)return e.done(),0;i.clone(t[s-1]);for(var a=0;s>a;++a)o.clone(t[a]),r+=i.cross(o),i.swap(o);return e.done(),r/2},n.geometry.getPolygonCentroid=function(t){var e,i=n.scratchpad(),o=i.vector(),r=i.vector(),s=new n.vector,a=t.length;if(2>a)return i.done(),new n.vector(t[0]);if(2===a)return i.done(),new n.vector((t[1].x+t[0].x)/2,(t[1].y+t[0].y)/2);o.clone(t[a-1]);for(var l=0;a>l;++l)r.clone(t[l]),e=o.cross(r),o.vadd(r).mult(e),s.vadd(o),o.swap(r);return e=1/(6*n.geometry.getPolygonArea(t)),i.done(),s.mult(e)},n.geometry.nearestPointOnLine=function(t,e,i){var o,r,s=n.scratchpad(),a=s.vector().clone(t),l=s.vector().clone(e).vsub(a),c=s.vector().clone(i).vsub(a).vsub(l);return c.equals(n.vector.zero)?(s.done(),new n.vector(e)):0>=(r=1-(o=-c.dot(l)/c.normSq()))?(s.done(),new n.vector(i)):0>=o?(s.done(),new n.vector(e)):(a=new n.vector(i).mult(o).vadd(l.clone(e).mult(r)),s.done(),a)},function(){var t={drag:0};n.integrator=i(\"integrator\",{init:function(e){this.options=n.util.options(t),this.options(e)},setWorld:function(t){return this.disconnect&&this._world&&this.disconnect(this._world),this._world=t,this.connect&&t&&this.connect(t),this},integrate:function(t,e){var n=this._world;return this.integrateVelocities(t,e),n&&n.emit(\"integrate:velocities\",{bodies:t,dt:e}),this.integratePositions(t,e),n&&n.emit(\"integrate:positions\",{bodies:t,dt:e}),this},connect:null,disconnect:null,integrateVelocities:function(){throw\"The integrator.integrateVelocities() method must be overriden\"},integratePositions:function(){throw\"The integrator.integratePositions() method must be overriden\"}})}(),function(){var o={meta:!1,metaRefresh:200,width:600,height:600,autoResize:!0};n.renderer=i(\"renderer\",{init:function(i){var r=this,s=\"string\"==typeof i.el?e.getElementById(i.el):i.el;this.options=n.util.options(o),this.options(i),this.el=s||e.body,this.container=s&&s.parentNode?s.parentNode:e.body,this.drawMeta=n.util.throttle(n.util.bind(this.drawMeta,this),this.options.metaRefresh),t.addEventListener(\"resize\",n.util.throttle((function(){r.options.autoResize&&r.resize()})),100)},resize:function(t,e){void 0===t&&void 0===e&&(t=this.container.offsetWidth,e=this.container.offsetHeight),this.width=t||0,this.height=e||0},setWorld:function(t){return this.disconnect&&this._world&&this.disconnect(this._world),this._world=t,this.connect&&t&&this.connect(t),this},render:function(t,e){var n,i;this.beforeRender&&this.beforeRender(),this._world.emit(\"beforeRender\",{renderer:this,bodies:t,meta:e}),this.options.meta&&this.drawMeta(e),this._interpolateTime=e.interpolateTime;for(var o=0,r=t.length;r>o;++o)i=(n=t[o]).view||(n.view=this.createView(n.geometry,n.styles)),n.hidden||this.drawBody(n,i);return this},createView:function(){throw\"You must override the renderer.createView() method.\"},drawMeta:function(){throw\"You must override the renderer.drawMeta() method.\"},drawBody:function(){throw\"You must override the renderer.drawBody() method.\"}})}(),function(){var t=function t(e,n,i){for(var o,r,s=function(){return t(e,n,i)};o=e.shift();)if((r=o.apply(n,i))&&r.then)return r.then(s)},e={timestep:6,maxIPF:4,webworker:!1,integrator:\"verlet\",sleepDisabled:!1,sleepSpeedLimit:.05,sleepVarianceLimit:.02,sleepTimeLimit:500},i=function t(e,n){return this instanceof t?void this.init(e,n):new t(e,n)};i.prototype=n.util.extend({},n.util.pubsub.prototype,{init:function(i,o){var r=this;(n.util.isFunction(i)||n.util.isArray(i))&&(o=i,i={}),this._meta={fps:0,ipf:0},this._bodies=[],this._behaviors=[],this._integrator=null,this._renderer=null,this._paused=!1,this._warp=1,this._time=0,this.options=n.util.options(e),this.options.onChange((function(t){r.timestep(t.timestep)})),this.options(i),this.add(n.integrator(this.options.integrator)),n.util.isFunction(o)?t([o],this,[this,n]):n.util.isArray(o)&&t(o,this,[this,n])},options:null,add:function(t){var e=0,i=t&&t.length||0,o=n.util.isArray(t)?t[0]:t;if(!o)return this;do{switch(o.type){case\"behavior\":this.addBehavior(o);break;case\"integrator\":this.integrator(o);break;case\"renderer\":this.renderer(o);break;case\"body\":this.addBody(o);break;default:throw'Error: failed to add item of unknown type \"'+o.type+'\" to world'}}while(++e<i&&(o=t[e]));return this},remove:function(t){var e=0,i=t&&t.length||0,o=n.util.isArray(t)?t[0]:t;if(!o)return this;do{switch(o.type){case\"behavior\":this.removeBehavior(o);break;case\"integrator\":o===this._integrator&&this.integrator(null);break;case\"renderer\":o===this._renderer&&this.renderer(null);break;case\"body\":this.removeBody(o);break;default:throw'Error: failed to remove item of unknown type \"'+o.type+'\" from world'}}while(++e<i&&(o=t[e]));return this},has:function(t){var e;if(!t)return!1;switch(t.type){case\"behavior\":e=this._behaviors;break;case\"integrator\":return this._integrator===t;case\"renderer\":return this._renderer===t;case\"body\":e=this._bodies;break;default:throw'Error: unknown type \"'+t.type+'\"'}return n.util.indexOf(e,t)>-1},integrator:function(t){return void 0===t?this._integrator:(this._integrator===t||(this._integrator&&(this._integrator.setWorld(null),this.emit(\"remove:integrator\",{integrator:this._integrator})),t&&(this._integrator=t,this._integrator.setWorld(this),this.emit(\"add:integrator\",{integrator:this._integrator}))),this)},renderer:function(t){return void 0===t?this._renderer:(this._renderer===t||(this._renderer&&(this._renderer.setWorld(null),this.emit(\"remove:renderer\",{renderer:this._renderer})),t&&(this._renderer=t,this._renderer.setWorld(this),this.emit(\"add:renderer\",{renderer:this._renderer}))),this)},timestep:function(t){return t?(this._dt=+t.toPrecision(4),this._maxJump=t*this.options.maxIPF,this):this._dt},wakeUpAll:function(){var t=0,e=this._bodies.length;for(t=0;e>t;t++)this._bodies[t].sleep(!1)},addBehavior:function(t){return this.has(t)||(t.setWorld(this),this._behaviors.push(t),this.emit(\"add:behavior\",{behavior:t})),this},getBehaviors:function(){return[].concat(this._behaviors)},removeBehavior:function(t){var e=this._behaviors;if(t)for(var n=0,i=e.length;i>n;++n)if(t===e[n]){e.splice(n,1),t.setWorld(null),this.emit(\"remove:behavior\",{behavior:t});break}return this},addBody:function(t){return this.has(t)||(t.setWorld(this),this._bodies.push(t),this.emit(\"add:body\",{body:t})),this},getBodies:function(){return[].concat(this._bodies)},removeBody:function(t){var e=this._bodies;if(t)for(var n=0,i=e.length;i>n;++n)if(t===e[n]){e.splice(n,1),t.setWorld(null),this.emit(\"remove:body\",{body:t});break}return this},findOne:function(t){var e=\"function\"==typeof t?t:n.query(t);return n.util.find(this._bodies,e)||!1},find:function(t){var e=\"function\"==typeof t?t:n.query(t);return n.util.filter(this._bodies,e)},iterate:function(t){this._integrator.integrate(this._bodies,t)},step:function(t){var e,i,o,r=this._time,s=this._warp,a=1/s,l=this._dt,c=l*a,h=this._maxJump*a,u=this._meta;if(this._paused||void 0===this._animTime)return this._animTime=t||this._animTime||n.util.ticker.now(),this._paused||this.emit(\"step\",u),this;if((e=(t=t||this._animTime+c)-this._animTime)>h&&(this._animTime=t-h,e=h),o=r+(i=e*s)-l,this.emit(\"beforeStep\"),o>=r)for(;o>=r;)r+=l,this._animTime+=c,this._time=r,this.iterate(l);return u.fps=1e3/(t-this._lastTime),u.ipf=(i/l).toFixed(2),u.interpolateTime=l+o-r,this._lastTime=t,this.emit(\"step\",u),this},warp:function(t){return void 0===t?this._warp:(this._warp=t||1,this)},render:function(){if(!this._renderer)throw\"No renderer added to world\";return this._renderer.render(this._bodies,this._meta),this.emit(\"render\",{bodies:this._bodies,meta:this._meta,renderer:this._renderer}),this},pause:function(){return this._paused=!0,this.emit(\"pause\"),this},unpause:function(){return this._paused=!1,this.emit(\"unpause\"),this},isPaused:function(){return!!this._paused},destroy:function(){var t=this;t.pause(),this.emit(\"destroy\"),t.off(!0),t.remove(t.getBodies()),t.remove(t.getBehaviors()),t.integrator(null),t.renderer(null)}}),n.world=i}(),n.integrator(\"verlet\",(function(t){return n.body.mixin({started:function(t){return void 0!==t&&(this._started=!0),!!this._started}}),{init:function(e){t.init.call(this,e)},integrateVelocities:function(t,e){for(var n,i=e*e,o=1-this.options.drag,r=null,s=.5*(i+e*(this.prevDt||e)),a=0,l=t.length;l>a;++a)n=(r=t[a]).state,\"static\"===r.treatment||r.sleep(e)?(n.vel.zero(),n.acc.zero(),n.angular.vel=0,n.angular.acc=0):(n.vel.equals(n.old.vel)&&r.started()?n.vel.clone(n.pos).vsub(n.old.pos):(n.old.pos.clone(n.pos).vsub(n.vel),n.vel.mult(e)),o&&n.vel.mult(o),n.vel.vadd(n.acc.mult(s)),n.vel.mult(1/e),n.old.vel.clone(n.vel),n.acc.zero(),n.angular.vel===n.old.angular.vel&&r.started()?n.angular.vel=n.angular.pos-n.old.angular.pos:(n.old.angular.pos=n.angular.pos-n.angular.vel,n.angular.vel*=e),n.angular.vel+=n.angular.acc*s,n.angular.vel/=e,n.old.angular.vel=n.angular.vel,n.angular.acc=0,r.started(!0))},integratePositions:function(t,e){for(var n,i=null,o=e/(this.prevDt||e),r=0,s=t.length;s>r;++r)n=(i=t[r]).state,\"static\"===i.treatment||i.sleep()||(n.vel.mult(e*o),n.old.pos.clone(n.pos),n.pos.vadd(n.vel),n.vel.mult(1/(e*o)),n.old.vel.clone(n.vel),n.angular.vel*=e*o,n.old.angular.pos=n.angular.pos,n.angular.pos+=n.angular.vel,n.angular.vel/=e*o,n.old.angular.vel=n.angular.vel);this.prevDt=e}}})),n.geometry(\"point\",(function(){})),n.body(\"point\",(function(t){return{init:function(e){t.init.call(this,e),this.moi=0}}})),n.geometry(\"circle\",(function(t){var e={radius:1};return{init:function(i){t.init.call(this,i),this.options.defaults(e),this.options.onChange((function(t){this.radius=t.radius})),this.options(i),this._aabb=n.aabb(),this.radius=this.options.radius},aabb:function(){var t=this.radius;return this._aabb.hw!==t&&(this._aabb=n.aabb(-t,-t,t,t)),n.aabb.clone(this._aabb)},getFarthestHullPoint:function(t,e){return(e=e||new n.vector).clone(t).normalize().mult(this.radius)},getFarthestCorePoint:function(t,e,i){return(e=e||new n.vector).clone(t).normalize().mult(this.radius-i)}}})),n.geometry(\"compound\",(function(t){var e={};return{init:function(n){t.init.call(this,n),this.options.defaults(e),this.options(n),this.children=[]},addChild:function(t,e,i){return this._aabb=null,this.children.push({g:t,pos:new n.vector(e),angle:i}),this},clear:function(){return this._aabb=null,this.children=[],this},aabb:function(t){if(!t&&this._aabb)return n.aabb.clone(this._aabb);var e,i,o,r=n.scratchpad(),s=n.vector();t=t||0;for(var a=0,l=this.children.length;l>a;a++)e=(i=this.children[a]).g.aabb(t+i.angle),s.clone(i.pos),t&&s.rotate(t),e.x+=s._[0],e.y+=s._[1],o=o?n.aabb.union(o,e,!0):e;return t||(this._aabb=n.aabb.clone(o)),r.done(o)},getFarthestHullPoint:function(t,e){var i,o,r=this.children.length,s=n.scratchpad(),a=s.vector(),l=0,c=0;for(e=e||new n.vector,o=0;r>o;o++)(i=this.children[o]).g.getFarthestHullPoint(t.rotate(-i.angle),a),(l=a.rotate(i.angle).vadd(i.pos).proj(t.rotate(i.angle)))>c&&(c=l,e.swap(a));return s.done(e)},getFarthestCorePoint:function(t,e,i){var o,r,s=this.children.length,a=n.scratchpad(),l=a.vector(),c=0,h=0;for(e=e||new n.vector,r=0;s>r;r++)(o=this.children[r]).g.getFarthestCorePoint(t.rotate(-o.angle),l,i),(c=l.rotate(o.angle).vadd(o.pos).proj(t.rotate(o.angle)))>h&&(h=c,e.swap(l));return a.done(e)}}})),n.geometry(\"convex-polygon\",(function(t){var e={};return{init:function(n){var i=this;t.init.call(this,n),this.options.defaults(e),this.options.onChange((function(t){i.setVertices(t.vertices||[])})),this.options(n),i.setVertices(this.options.vertices||[])},setVertices:function(t){var e=n.scratchpad(),i=e.transform(),o=this.vertices=[];if(!n.geometry.isPolygonConvex(t))throw\"Error: The vertices specified do not match that of a _convex_ polygon.\";i.setRotation(0),i.setTranslation(n.geometry.getPolygonCentroid(t).negate());for(var r=0,s=t.length;s>r;++r)o.push(new n.vector(t[r]).translate(i));return this._area=n.geometry.getPolygonArea(o),this._aabb=!1,e.done(this)},aabb:function(t){if(!t&&this._aabb)return n.aabb.clone(this._aabb);var e,i=n.scratchpad(),o=i.vector(),r=i.transform().setRotation(t||0),s=i.vector().set(1,0).rotateInv(r),a=i.vector().set(0,1).rotateInv(r),l=this.getFarthestHullPoint(s,o).proj(s),c=-this.getFarthestHullPoint(s.negate(),o).proj(s),h=this.getFarthestHullPoint(a,o).proj(a),u=-this.getFarthestHullPoint(a.negate(),o).proj(a);return e=n.aabb(c,u,l,h),t||(this._aabb=n.aabb.clone(e)),i.done(),e},getFarthestHullPoint:function(t,e,i){var o,r,s,a=this.vertices,l=a.length,c=2;if(e=e||new n.vector,2>l)return i&&(i.idx=0),e.clone(a[0]);if(r=a[0].dot(t),o=a[1].dot(t),2===l)return s=o>=r?1:0,i&&(i.idx=s),e.clone(a[s]);if(o>=r){for(;l>c&&o>=r;)r=o,o=a[c].dot(t),c++;return o>=r&&c++,s=c-2,i&&(i.idx=c-2),e.clone(a[s])}for(c=l;c>1&&r>=o;)o=r,r=a[--c].dot(t);return s=(c+1)%l,i&&(i.idx=s),e.clone(a[s])},getFarthestCorePoint:function(t,e,i){var o,r=n.scratchpad(),s=r.vector(),a=r.vector(),l=this.vertices,c=l.length,h=this._area>0,u={};return e=this.getFarthestHullPoint(t,e,u),s.clone(l[(u.idx+1)%c]).vsub(e).normalize().perp(h),a.clone(l[(u.idx-1+c)%c]).vsub(e).normalize().perp(!h),o=i/(1+s.dot(a)),e.vadd(s.vadd(a).mult(o)),r.done(),e}}})),n.geometry(\"rectangle\",(function(t){var e={};return{init:function(n){var i=this;t.init.call(this,n),this.options.defaults(e),this.options.onChange((function(){i.width=i.options.width||1,i.height=i.options.height||1})),this.options(n)},aabb:function(t){if(!t)return n.aabb(this.width,this.height);var e=n.scratchpad(),i=e.vector(),o=e.transform().setRotation(t||0),r=e.vector().set(1,0).rotateInv(o),s=e.vector().set(0,1).rotateInv(o),a=this.getFarthestHullPoint(r,i).proj(r),l=-this.getFarthestHullPoint(r.negate(),i).proj(r),c=this.getFarthestHullPoint(s,i).proj(s),h=-this.getFarthestHullPoint(s.negate(),i).proj(s);return e.done(),n.aabb(l,h,a,c)},getFarthestHullPoint:function(t,e){e=e||new n.vector;var i=t.x,o=t.y;return i=0===i?0:0>i?.5*-this.width:.5*this.width,o=0===o?0:0>o?.5*-this.height:.5*this.height,e.set(i,o)},getFarthestCorePoint:function(t,e,n){var i,o;return i=(e=this.getFarthestHullPoint(t,e)).x,o=e.y,e.x=0===i?0:0>i?i+n:i-n,e.y=0===o?0:0>o?o+n:o-n,e}}})),n.body(\"circle\",(function(t){var e={radius:1};return{init:function(i){t.init.call(this,i),i=n.util.extend({},e,i),this.geometry=n.geometry(\"circle\",{radius:i.radius}),this.recalc()},recalc:function(){t.recalc.call(this),this.moi=this.mass*this.geometry.radius*this.geometry.radius/2}}})),n.body(\"compound\",(function(t){return{init:function(e){t.init.call(this,e),this.mass=0,this.moi=0,this.children=[],this.geometry=n.geometry(\"compound\"),this.addChildren(e.children)},connect:function(){if(this.mass<=0)throw\"Can not add empty compound body to world.\"},addChild:function(t){return this.addChildren([t]),this},addChildren:function(t){var e,i,o,r=this,s=n.scratchpad(),a=s.vector().zero(),l=t&&t.length,c=0;if(!l)return s.done(this);for(o=0;l>o;o++)(e=t[o])._world&&e._world.remove(e),this.children.push(e),this.geometry.addChild(e.geometry,new n.vector(e.offset).rotate(e.state.angular.pos).vadd(e.state.pos),e.state.angular.pos),i=e.state.pos,a.add(i._[0]*e.mass,i._[1]*e.mass),c+=e.mass;return this.mass+=c,a.mult(1/this.mass),this.offset.vsub(a),this._world&&this._world.one(\"render\",(function(){r.view=null})),this.recalc(),s.done(this)},clear:function(){return this._aabb=null,this.moi=0,this.mass=0,this.offset.zero(),this.children=[],this.geometry.clear(),this},refreshGeometry:function(){this.geometry.clear();for(var t,e=0,i=this.children.length;i>e;e++)t=this.children[e],this.geometry.addChild(t.geometry,new n.vector(t.state.pos).vadd(t.offset),t.state.angular.pos);return this},recalc:function(){t.recalc.call(this);for(var e,n=0,i=0,o=this.children.length;o>i;i++)(e=this.children[i]).recalc(),n+=e.moi+e.mass*e.state.pos.normSq();return this.moi=n,this}}})),n.body(\"convex-polygon\",(function(t){var e={};return{init:function(i){t.init.call(this,i),i=n.util.extend({},e,i),this.geometry=n.geometry(\"convex-polygon\",{vertices:i.vertices}),this.recalc()},recalc:function(){t.recalc.call(this),this.moi=n.geometry.getPolygonMOI(this.geometry.vertices)}}})),n.body(\"rectangle\",(function(t){var e={};return{init:function(i){t.init.call(this,i),i=n.util.extend({},e,i),this.geometry=n.geometry(\"rectangle\",{width:i.width,height:i.height}),this.recalc()},recalc:function(){var e=this.geometry.width,n=this.geometry.height;t.recalc.call(this),this.moi=(e*e+n*n)*this.mass/12}}})),n.behavior(\"attractor\",(function(t){var e={pos:null,strength:1,order:2,max:!1,min:!1};return{init:function(i){var o=this;this._pos=new n.vector,t.init.call(this),this.options.defaults(e),this.options.onChange((function(t){o._maxDist=!1===t.max?1/0:t.max,o._minDist=t.min?t.min:10,o.position(t.pos)})),this.options(i)},position:function(t){return t?(this._pos.clone(t),this):this._pos.values()},behave:function(){for(var t,e,i,o=this.getTargets(),r=this.options.order,s=this.options.strength,a=this._minDist,l=this._maxDist,c=n.scratchpad(),h=c.vector(),u=0,d=o.length;d>u;u++)t=o[u],h.clone(this._pos),h.vsub(t.state.pos),(e=h.norm())>a&&l>e&&(i=s/Math.pow(e,r),t.accelerate(h.normalize().mult(i)));c.done()}}})),n.behavior(\"body-collision-detection\",(function(t){var e=[],i=function(t,i){var o=n.util.pairHash(t.uid,i.uid),r=e[o];return r||((r=e[o]=function(e){var n=r.tA,o=r.tB,s=r.tmpv1,a=r.tmpv2;return r.useCore?(s=t.geometry.getFarthestCorePoint(e.rotateInv(n),s,r.marginA),a=i.geometry.getFarthestCorePoint(e.rotate(n).rotateInv(o).negate(),a,r.marginB)):(s=t.geometry.getFarthestHullPoint(e.rotateInv(n),s),a=i.geometry.getFarthestHullPoint(e.rotate(n).rotateInv(o).negate(),a)),s.vadd(t.offset).transform(n),a.vadd(i.offset).transform(o),e.negate().rotate(o),{a:s.values(),b:a.values(),pt:s.vsub(a).values()}}).tA=new n.transform,r.tB=new n.transform,r.tmpv1=new n.vector,r.tmpv2=new n.vector),r.useCore=!1,r.margin=0,r.tA.setRotation(t.state.angular.pos).setTranslation(t.state.pos),r.tB.setRotation(i.state.angular.pos).setTranslation(i.state.pos),r.bodyA=t,r.bodyB=i,r},o=function(t,e){var o,r,s,a,l=n.scratchpad(),c=l.vector(),h=l.vector(),u=l.vector(),d=!1,p=t.aabb(),f=Math.min(p.hw,p.hh),v=e.aabb(),m=Math.min(v.hw,v.hh);if(s=i(t,e),c.clone(t.state.pos).vadd(t.getGlobalOffset(u)).vsub(e.state.pos).vsub(e.getGlobalOffset(u)),(r=n.gjk(s,c,!0)).overlap){for(d={bodyA:t,bodyB:e},a=.01*Math.min(f||1,m||1),s.useCore=!0,s.marginA=0,s.marginB=0;(r.overlap||0===r.distance)&&(s.marginA<f||s.marginB<m);)s.marginA<f&&(s.marginA+=a),s.marginB<m&&(s.marginB+=a),r=n.gjk(s,c);if(r.overlap||r.maxIterationsReached)return l.done(!1);if(0>=(o=s.marginA+s.marginB-r.distance))return l.done(!1);d.overlap=o,d.norm=c.clone(r.closest.b).vsub(h.clone(r.closest.a)).normalize().values(),d.mtv=c.mult(o).values(),d.pos=c.clone(d.norm).mult(s.marginA).vadd(h.clone(r.closest.a)).vsub(t.state.pos).values()}return l.done(d)},r=function t(e,i){if(!(\"static\"!==e.treatment&&\"kinematic\"!==e.treatment||\"static\"!==i.treatment&&\"kinematic\"!==i.treatment))return!1;if(\"circle\"===e.geometry.name&&\"circle\"===i.geometry.name)return function(t,e){var i,o=n.scratchpad(),r=o.vector(),s=o.vector(),a=!1;return r.clone(e.state.pos).vadd(e.getGlobalOffset(s)).vsub(t.state.pos).vsub(t.getGlobalOffset(s)),i=r.norm()-(t.geometry.radius+e.geometry.radius),r.equals(n.vector.zero)&&r.set(1,0),0>=i&&(a={bodyA:t,bodyB:e,norm:r.normalize().values(),mtv:r.mult(-i).values(),pos:r.mult(-t.geometry.radius/i).vadd(s).values(),overlap:-i}),o.done(a)}(e,i);if(\"compound\"===e.geometry.name||\"compound\"===i.geometry.name){var r,s,a,l,c=\"compound\"===e.geometry.name,h=c?e:i,u=c?i:e,d=[],p=n.scratchpad(),f=(p.vector(),p.vector()),v=u.aabb();for(a=0,l=h.children.length;l>a;a++){if(s=h.children[a],f.clone(s.state.pos),s.offset.vadd(f.vadd(h.offset).rotate(-s.state.angular.pos)),s.state.pos.clone(h.state.pos),s.state.angular.pos+=h.state.angular.pos,n.aabb.overlap(v,s.aabb()))if((r=t(u,s))instanceof Array)for(var m,g=0,y=r.length;y>g;g++)(m=r[g]).bodyA===s?m.bodyA=h:m.bodyB=h,d.push(m);else r&&(r.bodyA===s?r.bodyA=h:r.bodyB=h,d.push(r));s.state.angular.pos-=h.state.angular.pos,s.offset.vsub(f),s.state.pos.clone(f.rotate(s.state.angular.pos).vsub(h.offset))}return p.done(d)}return o(e,i)},s={check:\"collisions:candidates\",channel:\"collisions:detected\"};return{init:function(e){t.init.call(this),this.options.defaults(s),this.options(e)},connect:function(t){!0===this.options.check?t.on(\"integrate:velocities\",this.checkAll,this):t.on(this.options.check,this.check,this)},disconnect:function(t){!0===this.options.check?t.off(\"integrate:velocities\",this.checkAll,this):t.off(this.options.check,this.check,this)},check:function(t){for(var e,i,o,s=t.candidates,a=this.getTargets(),l=[],c=this.prevContacts||{},h={},u=n.util.pairHash,d=0,p=s.length;p>d;++d)if(e=s[d],a===this._world._bodies||n.util.indexOf(a,e.bodyA)>-1&&n.util.indexOf(a,e.bodyB)>-1)if((i=r(e.bodyA,e.bodyB))instanceof Array)for(var f,v=0,m=i.length;m>v;v++)(f=i[v])&&(h[o=u(e.bodyA.uid,e.bodyB.uid)]=!0,f.collidedPreviously=c[o],l.push(f));else i&&(h[o=u(e.bodyA.uid,e.bodyB.uid)]=!0,i.collidedPreviously=c[o],l.push(i));this.prevContacts=h,l.length&&this._world.emit(this.options.channel,{collisions:l})},checkAll:function(t){for(var e,i,o,s,a=this.getTargets(),l=(t.dt,[]),c=this.prevContacts||{},h={},u=n.util.pairHash,d=0,p=a.length;p>d;d++){e=a[d];for(var f=d+1;p>f;f++)if(i=a[f],(o=r(e,i))instanceof Array)for(var v,m=0,g=o.length;g>m;m++)(v=o[m])&&(h[s=u(e.uid,i.uid)]=!0,v.collidedPreviously=c[s],l.push(v));else o&&(h[s=u(e.uid,i.uid)]=!0,o.collidedPreviously=c[s],l.push(o))}this.prevContacts=h,l.length&&this._world.emit(this.options.channel,{collisions:l})}}})),n.behavior(\"body-impulse-response\",(function(t){function e(t){return t.uid}function i(t,e,n){var i,o;return i=(o=e.norm())-t.proj(e),i=Math.max(0,Math.min(o,i)),0===o?n.zero():n.clone(e).mult(i/o),n}var o={check:\"collisions:detected\",mtvThreshold:1,bodyExtractDropoff:.5,forceWakeupAboveOverlapThreshold:!0};return{init:function(e){t.init.call(this),this.options.defaults(o),this.options(e),this._bodyList=[]},applyTo:!1,connect:function(t){t.on(this.options.check,this.respond,this)},disconnect:function(t){t.off(this.options.check,this.respond,this)},collideBodies:function(t,e,o,r,s,a){var l=\"static\"===t.treatment||\"kinematic\"===t.treatment,c=\"static\"===e.treatment||\"kinematic\"===e.treatment,h=n.scratchpad(),u=h.vector().clone(s);if(!l||!c){var d,p,f,v=l?0:1/t.moi,m=c?0:1/e.moi,g=l?0:1/t.mass,y=c?0:1/e.mass,b=t.restitution*e.restitution,_=t.cof*e.cof,w=h.vector().clone(o),x=h.vector().clone(w).perp(),P=h.vector(),C=h.vector().clone(r),A=h.vector().clone(r).vadd(t.state.pos).vsub(e.state.pos),k=t.state.angular.vel,T=e.state.angular.vel,I=h.vector().clone(e.state.vel).vadd(P.clone(A).perp().mult(T)).vsub(t.state.vel).vsub(P.clone(C).perp().mult(k)),B=C.proj(w),M=C.proj(x),S=A.proj(w),L=A.proj(x),j=I.proj(w),O=I.proj(x);return a&&(l?(i(e._mtvTotal,u,P),e._mtvTotal.vadd(P)):c?(i(t._mtvTotal,u.negate(),P),t._mtvTotal.vadd(P),u.negate()):(u.mult(.5),i(e._mtvTotal,u,P),e._mtvTotal.vadd(P),u.clone(s).mult(-.5),i(t._mtvTotal,u,P),t._mtvTotal.vadd(P))),j>=0||(d=-(1+b)*j/(g+y+(v=1/0===v?0:v)*M*M+(m=1/0===m?0:m)*L*L),l?(e.state.vel.vadd(w.mult(d*y)),e.state.angular.vel-=d*m*L):c?(t.state.vel.vsub(w.mult(d*g)),t.state.angular.vel+=d*v*M):(e.state.vel.vadd(w.mult(d*y)),e.state.angular.vel-=d*m*L,t.state.vel.vsub(w.mult(g*e.mass)),t.state.angular.vel+=d*v*M),_&&O&&(f=Math.abs(O)/(g+y+v*B*B+m*S*S),p=0>O?-1:1,d=_*Math.abs(d),d=Math.min(d,f),d*=p,l?(e.state.vel.vsub(x.mult(d*y)),e.state.angular.vel-=d*m*S):c?(t.state.vel.vadd(x.mult(d*g)),t.state.angular.vel+=d*v*B):(e.state.vel.vsub(x.mult(d*y)),e.state.angular.vel-=d*m*S,t.state.vel.vadd(x.mult(g*e.mass)),t.state.angular.vel+=d*v*B)),t.sleep()&&t.sleepCheck(),e.sleep()&&e.sleepCheck()),void h.done()}h.done()},_pushUniq:function(t){var i=n.util.sortedIndex(this._bodyList,t,e);this._bodyList[i]!==t&&this._bodyList.splice(i,0,t)},respond:function(t){var e,i,o,r,s=t.collisions;for(i=0,o=s.length;o>i;++i)e=s[i],this._pushUniq(e.bodyA),this._pushUniq(e.bodyB),e.bodyA._mtvTotal=e.bodyA._mtvTotal||new n.vector,e.bodyB._mtvTotal=e.bodyB._mtvTotal||new n.vector,e.bodyA._oldmtvTotal=e.bodyA._oldmtvTotal||new n.vector,e.bodyB._oldmtvTotal=e.bodyB._oldmtvTotal||new n.vector,this.collideBodies(e.bodyA,e.bodyB,e.norm,e.pos,e.mtv,e.collidedPreviously);for(i=0,o=this._bodyList.length;o>i;++i)(r=this._bodyList.pop())._mtvTotal.normSq()<this.options.mtvThreshold?r._mtvTotal.mult(this.options.bodyExtractDropoff):this.options.forceWakeupAboveOverlapThreshold&&r.sleep(!1),r.state.pos.vadd(r._mtvTotal),r.state.old.pos.vadd(r._mtvTotal),r._oldmtvTotal.swap(r._mtvTotal),r._mtvTotal.zero()}}})),n.behavior(\"constant-acceleration\",(function(t){var e={acc:{x:0,y:4e-4}};return{init:function(i){t.init.call(this),this.options.defaults(e),this.options(i),this._acc=new n.vector,this.setAcceleration(this.options.acc),delete this.options.acc},setAcceleration:function(t){return this._acc.clone(t),this},behave:function(){for(var t=this.getTargets(),e=0,n=t.length;n>e;++e)t[e].accelerate(this._acc)}}})),n.behavior(\"edge-collision-detection\",(function(t){var e=function(t,e,i){var o,r=t.aabb(),s=n.scratchpad(),a=t.getGlobalOffset(s.vector()),l=s.transform(),c=s.vector(),h=s.vector(),u=!1,d=[];return(o=r.x+r.hw-e.max.x)>=0&&(c.set(1,0).rotateInv(l.setRotation(t.state.angular.pos)),u={bodyA:t,bodyB:i,overlap:o,norm:{x:1,y:0},mtv:{x:o,y:0},pos:t.geometry.getFarthestHullPoint(c,h).rotate(l).vadd(a).values()},d.push(u)),(o=r.y+r.hh-e.max.y)>=0&&(c.set(0,1).rotateInv(l.setRotation(t.state.angular.pos)),u={bodyA:t,bodyB:i,overlap:o,norm:{x:0,y:1},mtv:{x:0,y:o},pos:t.geometry.getFarthestHullPoint(c,h).rotate(l).vadd(a).values()},d.push(u)),(o=e.min.x-(r.x-r.hw))>=0&&(c.set(-1,0).rotateInv(l.setRotation(t.state.angular.pos)),u={bodyA:t,bodyB:i,overlap:o,norm:{x:-1,y:0},mtv:{x:-o,y:0},pos:t.geometry.getFarthestHullPoint(c,h).rotate(l).vadd(a).values()},d.push(u)),(o=e.min.y-(r.y-r.hh))>=0&&(c.set(0,-1).rotateInv(l.setRotation(t.state.angular.pos)),u={bodyA:t,bodyB:i,overlap:o,norm:{x:0,y:-1},mtv:{x:0,y:-o},pos:t.geometry.getFarthestHullPoint(c,h).rotate(l).vadd(a).values()},d.push(u)),s.done(),d},i=function(t,n,i){return e(t,n,i)},o={aabb:null,restitution:.99,cof:1,channel:\"collisions:detected\"};return{init:function(e){t.init.call(this),this.options.defaults(o),this.options(e),this.setAABB(this.options.aabb),this.restitution=this.options.restitution,this.body=n.body(\"point\",{treatment:\"static\",restitution:this.options.restitution,cof:this.options.cof})},setAABB:function(t){if(!t)throw\"Error: aabb not set\";return this._edges={min:{x:t.x-t.hw,y:t.y-t.hh},max:{x:t.x+t.hw,y:t.y+t.hh}},this},connect:function(t){t.on(\"integrate:positions\",this.checkAll,this,2)},disconnect:function(t){t.off(\"integrate:positions\",this.checkAll,this,2)},checkAll:function(t){for(var e,o,r,s=this.getTargets(),a=(t.dt,[]),l=this._edges,c=this.body,h=this.prevContacts||{},u={},d=n.util.pairHash,p=0,f=s.length;f>p;p++)if(\"dynamic\"===(e=s[p]).treatment&&(o=i(e,l,c))){r=d(e.uid,c.uid);for(var v=0,m=o.length;m>v;v++)u[r]=!0,o[v].collidedPreviously=h[r];a.push.apply(a,o)}this.prevContacts=u,a.length&&this._world.emit(this.options.channel,{collisions:a})}}})),n.behavior(\"interactive\",(function(i){if(!e)return{};var o={el:null,moveThrottle:10,minVel:{x:-5,y:-5},maxVel:{x:5,y:5}},r=function(t){var e=0,n=0;if(t.offsetParent)do{e+=t.offsetLeft,n+=t.offsetTop}while(t=t.offsetParent);return{left:e,top:n}};return{init:function(t){var s=this;if(i.init.call(this),this.options.defaults(o),this.options(t),this.bodyData={},this.bodyDataByUID={},this.el=\"string\"==typeof this.options.el?e.getElementById(this.options.el):this.options.el,!this.el)throw\"No DOM element specified\";s.grab=function(t){var e,i,o,a,l,c,h,u;if(s._world)for(t.changedTouches||(t.changedTouches=[t]),l=r(t.target),h=0,u=t.changedTouches.length;u>h;h++)e={idx:o=(a=t.changedTouches[h]).identifier||a.pointerId||\"mouse\",x:a.pageX-l.left,y:a.pageY-l.top},(i=s._world.findOne({$at:new n.vector(e),$in:s.getTargets()}))?(i.state.vel.zero(),i.state.angular.vel=0,i.isGrabbed=!0,(c=s.bodyData[o]||{}).body=i,i.sleep(!1),c.time=n.util.ticker.now(),c.treatment=s.bodyDataByUID[i.uid]?s.bodyDataByUID[i.uid].treatment:i.treatment,i.treatment=\"kinematic\",c.pos=c.pos||new n.vector,c.pos.clone(e),c.offset=c.offset||new n.vector,c.offset.clone(e).vsub(i.state.pos),c.oldPos=c.oldPos||new n.vector,c.oldPos.clone(e),e.body=i,s.bodyData[o]=c,s.bodyDataByUID[i.uid]=c,s._world.emit(\"interact:grab\",e)):s._world.emit(\"interact:poke\",e)},s.move=n.util.throttle((function(t){var e,i,o,a,l,c,h,u;if(s._world)for(t.changedTouches||(t.changedTouches=[t]),l=r(s.el),h=0,u=t.changedTouches.length;u>h;h++)e={idx:o=(a=t.changedTouches[h]).identifier||a.pointerId||\"mouse\",x:a.pageX-l.left,y:a.pageY-l.top},(c=s.bodyData[o])&&((i=c.body).sleep(!1),c.time=n.util.ticker.now(),c.oldPos.clone(c.pos),c.pos.clone(e),e.body=i),s._world.emit(\"interact:move\",e)}),s.options.moveThrottle),s.release=function(t){var e,i,o,a,l,c,h,u,d;if(s._world)for(t.changedTouches||(t.changedTouches=[t]),u=0,d=t.changedTouches.length;d>u;u++)l=r(s.el),e={idx:o=(a=t.changedTouches[u]).identifier||a.pointerId||\"mouse\",x:a.pageX-l.left,y:a.pageY-l.top},(c=s.bodyData[o])&&((i=c.body).sleep(!1),c.pos.clone(e),h=Math.max(n.util.ticker.now()-c.time,s.options.moveThrottle),i.treatment=c.treatment,i.state.vel.clone(c.pos).vsub(c.oldPos).mult(1/h),i.state.vel.clamp(s.options.minVel,s.options.maxVel),i.isGrabbed=!1,e.body=i,delete i.isGrabbed),s._world.emit(\"interact:release\",e),delete s.bodyData[o]}},connect:function(e){e.on(\"integrate:positions\",this.behave,this),t.PointerEvent?(this.el.addEventListener(\"pointerdown\",this.grab),t.addEventListener(\"pointermove\",this.move),t.addEventListener(\"pointerup\",this.release)):(this.el.addEventListener(\"mousedown\",this.grab),this.el.addEventListener(\"touchstart\",this.grab),t.addEventListener(\"mousemove\",this.move),t.addEventListener(\"touchmove\",this.move),t.addEventListener(\"mouseup\",this.release),t.addEventListener(\"touchend\",this.release))},disconnect:function(e){e.off(\"integrate:positions\",this.behave,this),t.PointerEvent?(this.el.removeEventListener(\"pointerdown\",this.grab),t.removeEventListener(\"pointermove\",this.move),t.removeEventListener(\"pointerup\",this.release)):(this.el.removeEventListener(\"mousedown\",this.grab),this.el.removeEventListener(\"touchstart\",this.grab),t.removeEventListener(\"mousemove\",this.move),t.removeEventListener(\"touchmove\",this.move),t.removeEventListener(\"mouseup\",this.release),t.removeEventListener(\"touchend\",this.release))},behave:function(t){var e,n,i=this,o=Math.max(t.dt,i.options.moveThrottle);for(var r in i.bodyData)(e=(n=i.bodyData[r]).body.state).vel.clone(n.pos).vsub(n.offset).vsub(e.pos).mult(1/o)}}})),n.behavior(\"newtonian\",(function(t){var e={strength:1,max:!1,min:!1};return{init:function(n){var i=this;t.init.call(this),this.options.defaults(e),this.options.onChange((function(t){i._maxDistSq=!1===t.max?1/0:t.max*t.max,i._minDistSq=t.min?t.min*t.min:100*t.strength})),this.options(n)},calcPotential:function(t,e,i){var o,r,s,a=this.options.strength,l=this._minDistSq,c=this._maxDistSq;return(s=i||new n.vector).clone(e).vsub(t),(o=s.normSq())>l&&c>o?(r=a/o,s.normalize().mult(r)):s.zero()},behave:function(){var t,e,i,o,r,s,a,l,c,h,u,d,p=this.getTargets(),f=n.scratchpad(),v=f.vector(),m=f.vector(),g=f.vector();for(a=0,h=p.length;h>a;a++)for(t=p[a],s=a+1;h>s;s++){if(e=p[s],\"compound\"===t.name?i=t:\"compound\"===e.name&&(i=e,e=t),i)if(\"compound\"===e.name)for(l=0,u=i.children.length;u>l;l++)for(o=i.children[l],i.toWorldCoords(m.clone(o.state.pos).vadd(i.offset)),c=0,d=e.children.length;d>c;c++)r=e.children[c],e.toWorldCoords(g.clone(r.state.pos).vadd(e.offset)),this.calcPotential(m,g,v),i.accelerate(v.mult(r.mass)),e.accelerate(v.mult(o.mass/r.mass).negate());else for(l=0,u=i.children.length;u>l;l++)o=i.children[l],i.toWorldCoords(m.clone(o.state.pos).vadd(i.offset)),this.calcPotential(m,e.state.pos,v),i.accelerate(v.mult(e.mass)),e.accelerate(v.mult(o.mass/e.mass).negate());else this.calcPotential(t.state.pos,e.state.pos,v),t.accelerate(v.mult(e.mass)),e.accelerate(v.mult(t.mass/e.mass).negate());i=null}f.done()}}})),n.behavior(\"sweep-prune\",(function(t){var e=1,i=function(){return e++},o={x:0,y:1},r=n.util.pairHash;return{init:function(e){t.init.call(this),this.options.defaults({channel:\"collisions:candidates\"}),this.options(e),this.encounters=[],this.candidates=[],this.clear()},clear:function(){this.tracked=[],this.pairs=[],this.intervalLists=[];for(var t=0;2>t;++t)this.intervalLists[t]=[]},connect:function(t){t.on(\"add:body\",this.trackBody,this),t.on(\"remove:body\",this.untrackBody,this),t.on(\"integrate:positions\",this.sweep,this,1);for(var e=t.getBodies(),n=0,i=e.length;i>n;++n)this.trackBody({body:e[n]})},disconnect:function(t){t.off(\"add:body\",this.trackBody,this),t.off(\"remove:body\",this.untrackBody,this),t.off(\"integrate:positions\",this.sweep,this,1),this.clear()},broadPhase:function(){return this.updateIntervals(),this.sortIntervalLists(),this._world&&this._world.emit(\"sweep-prune:intervals\",this.intervalLists),this.checkOverlaps()},sortIntervalLists:function(){for(var t,e,n,i,o,r,s,a,l,c=0;2>c;++c)for(n=0,e=(t=this.intervalLists[c]).length,l=c;++n<e;){for(r=(o=t[n]).val.get(l),a=(s=t[(i=n)-1])&&s.val.get(l);i>0&&(a>r||a===r&&s.type&&!o.type);)t[i]=s,a=(s=t[--i-1])&&s.val.get(l);t[i]=o}},getPair:function(t,e,n){var i=r(t.id,e.id);if(!1===i)return null;var o=this.pairs[i];if(!o){if(!n)return null;o=this.pairs[i]={bodyA:t.body,bodyB:e.body,flag:1}}return n&&(o.flag=1),o},checkOverlaps:function(){var t,e,i,r,s,a,l,c,h,u=1<<o.z+1<<o.y+1<<o.x+1,d=this.encounters,p=0,f=this.candidates;n.util.clearArray(d),n.util.clearArray(f);for(var v=0;2>v;++v)for(t=0===v,l=0,a=(s=this.intervalLists[v]).length;a>l;l++)if(e=(r=s[l]).tracker,r.type)for(c=p,c=p-1;c>=0;c--)(i=d[c])===e?(p-1>c?d[c]=d.pop():d.pop(),p--):(h=this.getPair(e,i,t))&&h.flag<u&&(h.flag=h.flag<<v+1,h.flag===u&&f.push(h));else p=d.push(e);return f},updateIntervals:function(){for(var t,e,n,i=this.tracked,o=i.length;--o>=0;)e=(t=i[o]).interval,n=t.body.aabb(),e.min.val.clone(n).sub(n.hw,n.hh),e.max.val.clone(n).add(n.hw,n.hh)},trackBody:function(t){var e=t.body,o={id:i(),body:e},r={min:{type:!1,val:new n.vector,tracker:o},max:{type:!0,val:new n.vector,tracker:o}};o.interval=r,this.tracked.push(o);for(var s=0;2>s;++s)this.intervalLists[s].push(r.min,r.max)},untrackBody:function(t){for(var e,n,i,o,r=t.body,s=this.tracked,a=0,l=s.length;l>a;++a)if((i=s[a]).body===r){s.splice(a,1);for(var c=0;2>c;++c){o=0;for(var h=0,u=(e=this.intervalLists[c]).length;u>h;++h)if((n=e[h])===i.interval.min||n===i.interval.max){if(e.splice(h,1),h--,l--,o>0)break;o++}}break}},sweep:function(){var t;(t=this.broadPhase()).length&&this._world.emit(this.options.channel,{candidates:t})}}})),n.behavior(\"verlet-constraints\",(function(t){var e=2*Math.PI,i={iterations:2};return{init:function(e){t.init.call(this),this.options.defaults(i),this.options(e),this._distanceConstraints=[],this._angleConstraints=[]},connect:function(t){var e=t.integrator();if(e&&e.name.indexOf(\"verlet\")<0)throw'The rigid constraint manager needs a world with a \"verlet\" compatible integrator.';t.on(\"integrate:positions\",this.resolve,this)},disconnect:function(t){t.off(\"integrate:positions\",this.resolve,this)},drop:function(){return this._distanceConstraints=[],this._angleConstraints=[],this},distanceConstraint:function(t,e,i,o){var r;return!(!t||!e)&&((r={id:n.util.uniqueId(\"dis-constraint\"),type:\"dis\",bodyA:t,bodyB:e,stiffness:i||.5,targetLength:o||e.state.pos.dist(t.state.pos)}).targetLengthSq=r.targetLength*r.targetLength,this._distanceConstraints.push(r),r)},angleConstraint:function(t,e,i,o,r){var s;return!(!t||!e)&&(s={id:n.util.uniqueId(\"ang-constraint\"),type:\"ang\",bodyA:t,bodyB:e,bodyC:i,stiffness:o||.5,targetAngle:r||e.state.pos.angle2(t.state.pos,i.state.pos)},this._angleConstraints.push(s),s)},remove:function(t){var e,i,o,r;if(e=\"ang\"===((i=n.util.isObject(t))?t.type:t.substr(0,3))?this._angleConstraints:this._distanceConstraints,i){for(o=0,r=e.length;r>o;++o)if(e[o]===t)return e.splice(o,1),this}else for(o=0,r=e.length;r>o;++o)if(e[o].id===t)return e.splice(o,1),this;return this},resolveAngleConstraints:function(t){for(var i,o,r,s,a=this._angleConstraints,l=n.scratchpad(),c=l.transform(),h=0,u=a.length;u>h;++h)(r=(o=(i=a[h]).bodyB.state.pos.angle2(i.bodyA.state.pos,i.bodyC.state.pos))-i.targetAngle)&&(r<=-Math.PI?r+=e:r>=Math.PI&&(r-=e),c.setTranslation(i.bodyB.state.pos),r*=-t*i.stiffness,\"dynamic\"===i.bodyA.treatment&&\"dynamic\"===i.bodyB.treatment&&\"dynamic\"===i.bodyC.treatment&&(s=1/(i.bodyA.mass+i.bodyB.mass+i.bodyC.mass)),\"dynamic\"===i.bodyA.treatment&&(o=\"dynamic\"===i.bodyB.treatment&&\"dynamic\"===i.bodyC.treatment?r*(i.bodyB.mass+i.bodyC.mass)*s:\"dynamic\"!==i.bodyB.treatment?r*i.bodyC.mass/(i.bodyC.mass+i.bodyA.mass):r*i.bodyB.mass/(i.bodyB.mass+i.bodyA.mass),c.setRotation(o),i.bodyA.state.pos.translateInv(c),i.bodyA.state.pos.rotate(c),i.bodyA.state.pos.translate(c)),\"dynamic\"===i.bodyC.treatment&&(o=\"dynamic\"===i.bodyA.treatment&&\"dynamic\"===i.bodyB.treatment?-r*(i.bodyB.mass+i.bodyA.mass)*s:\"dynamic\"!==i.bodyB.treatment?-r*i.bodyA.mass/(i.bodyC.mass+i.bodyA.mass):-r*i.bodyB.mass/(i.bodyB.mass+i.bodyC.mass),c.setRotation(o),i.bodyC.state.pos.translateInv(c),i.bodyC.state.pos.rotate(c),i.bodyC.state.pos.translate(c)),\"dynamic\"===i.bodyB.treatment&&(o=\"dynamic\"===i.bodyA.treatment&&\"dynamic\"===i.bodyC.treatment?r*(i.bodyA.mass+i.bodyC.mass)*s:\"dynamic\"!==i.bodyA.treatment?r*i.bodyC.mass/(i.bodyC.mass+i.bodyB.mass):r*i.bodyA.mass/(i.bodyA.mass+i.bodyC.mass),c.setRotation(o).setTranslation(i.bodyA.state.pos),i.bodyB.state.pos.translateInv(c),i.bodyB.state.pos.rotate(c),i.bodyB.state.pos.translate(c),c.setTranslation(i.bodyC.state.pos),i.bodyB.state.pos.translateInv(c),i.bodyB.state.pos.rotateInv(c),i.bodyB.state.pos.translate(c)),i.bodyA.sleepCheck(),i.bodyB.sleepCheck(),i.bodyC.sleepCheck());l.done()},resolveDistanceConstraints:function(t){for(var e,i,o,r,s=this._distanceConstraints,a=n.scratchpad(),l=a.vector(),c=0,h=s.length;h>c;++c)e=s[c],l.clone(e.bodyB.state.pos).vsub(e.bodyA.state.pos),i=l.normSq()||1e-4*Math.random(),o=t*e.stiffness*(i-e.targetLengthSq)/i,l.mult(o),r=\"dynamic\"!==e.bodyA.treatment||\"dynamic\"!==e.bodyB.treatment?1:e.bodyB.mass/(e.bodyA.mass+e.bodyB.mass),\"dynamic\"===e.bodyA.treatment&&(\"dynamic\"===e.bodyB.treatment&&l.mult(r),e.bodyA.state.pos.vadd(l),\"dynamic\"===e.bodyB.treatment&&l.mult(1/r)),\"dynamic\"===e.bodyB.treatment&&(\"dynamic\"===e.bodyA.treatment&&l.mult(1-r),e.bodyB.state.pos.vsub(l)),e.bodyA.sleepCheck(),e.bodyB.sleepCheck();a.done()},shuffleConstraints:function(){this._distanceConstraints=n.util.shuffle(this._distanceConstraints),this._angleConstraints=n.util.shuffle(this._angleConstraints)},resolve:function(){for(var t=this.options.iterations,e=1/t,n=0;t>n;n++)this.resolveDistanceConstraints(e),this.resolveAngleConstraints(e)},getConstraints:function(){return{distanceConstraints:[].concat(this._distanceConstraints),angleConstraints:[].concat(this._angleConstraints)}}}})),n.integrator(\"improved-euler\",(function(t){return{init:function(e){t.init.call(this,e)},integrateVelocities:function(t,e){for(var n,i=1-this.options.drag,o=null,r=0,s=t.length;s>r;++r)n=(o=t[r]).state,\"static\"===o.treatment||o.sleep(e)?(n.vel.zero(),n.acc.zero(),n.angular.vel=0,n.angular.acc=0):(n.old.vel.clone(n.vel),n.old.acc.clone(n.acc),n.vel.vadd(n.acc.mult(e)),i&&n.vel.mult(i),n.acc.zero(),n.old.angular.vel=n.angular.vel,n.angular.vel+=n.angular.acc*e,n.angular.acc=0)},integratePositions:function(t,e){for(var i,o=.5*e*e,r=null,s=n.scratchpad(),a=s.vector(),l=0,c=t.length;c>l;++l)i=(r=t[l]).state,\"static\"===r.treatment||r.sleep()||(i.old.pos.clone(i.pos),a.clone(i.old.vel),i.pos.vadd(a.mult(e)).vadd(i.old.acc.mult(o)),i.old.acc.zero(),i.old.angular.pos=i.angular.pos,i.angular.pos+=i.old.angular.vel*e+i.old.angular.acc*o,i.old.angular.acc=0);s.done()}}})),n.integrator(\"velocity-verlet-alt\",(function(t){return n.body.mixin({started:function(t){return void 0!==t&&(this._started=!0),!!this._started}}),{init:function(e){t.init.call(this,e)},integrateVelocities:function(t,e){for(var n,i=1-this.options.drag,o=null,r=0,s=t.length;s>r;++r)n=(o=t[r]).state,\"static\"!==o.treatment?(o.started()||(n.old.acc.clone(n.acc),n.old.acc.mult(e),n.old.vel.clone(n.vel).vsub(n.old.acc),n.old.acc.mult(1/e)),i&&n.vel.mult(i),n.vel.vadd(n.old.acc.vadd(n.acc).mult(.5*e)),o.started()||(n.old.angular.acc=n.angular.acc,n.old.angular.vel=n.angular.vel-n.old.angular.acc*e),n.angular.vel+=.5*(n.angular.acc+n.old.angular.acc)*e,n.angular.acc=0,o.started(!0)):(n.vel.zero(),n.acc.zero(),n.angular.vel=0,n.angular.acc=0)},integratePositions:function(t,e){for(var n,i=e*e,o=null,r=0,s=t.length;s>r;++r)n=(o=t[r]).state,\"static\"!==o.treatment&&(n.old.pos.clone(n.pos),n.old.vel.mult(e),n.old.acc.mult(.5*i),n.pos.vadd(n.old.vel).vadd(n.old.acc),n.old.vel.clone(n.vel),n.old.acc.clone(n.acc),n.acc.zero(),n.old.angular.pos=n.angular.pos,n.angular.pos+=n.angular.vel*e+.5*n.old.angular.acc*i,n.old.angular.vel=n.angular.vel,n.old.angular.acc=n.angular.acc,n.angular.acc=0)}}})),n.integrator(\"velocity-verlet\",(function(t){return n.body.mixin({started:function(t){return void 0!==t&&(this._started=!0),!!this._started}}),{init:function(e){t.init.call(this,e)},integrate:function(t,e){var n=this._world;return this.integratePositions(t,e),n&&n.emit(\"integrate:positions\",{bodies:t,dt:e}),this.integrateVelocities(t,e),n&&n.emit(\"integrate:velocities\",{bodies:t,dt:e}),this},integrateVelocities:function(t,e){for(var n,i=1-this.options.drag,o=null,r=0,s=t.length;s>r;++r)n=(o=t[r]).state,\"static\"===o.treatment||o.sleep()?(n.vel.zero(),n.acc.zero(),n.angular.vel=0,n.angular.acc=0):(i&&n.vel.mult(i),n.old.vel.clone(n.vel),n.vel.vadd(n.old.acc.vadd(n.acc).mult(.5*e)),n.old.acc.clone(n.acc),n.acc.zero(),n.old.angular.vel=n.angular.vel,n.old.angular.acc=n.angular.acc,n.angular.vel+=.5*(n.angular.acc+n.old.angular.acc)*e,n.angular.acc=0,o.started(!0))},integratePositions:function(t,e){for(var n,i=e*e,o=null,r=0,s=t.length;s>r;++r)n=(o=t[r]).state,\"static\"===o.treatment||o.sleep(e)||(o.started()||(n.old.acc.clone(n.acc),n.old.acc.mult(e),n.old.vel.clone(n.vel).vsub(n.old.acc),n.old.acc.mult(1/e)),n.old.pos.clone(n.pos),n.old.vel.mult(e),n.old.acc.mult(.5*i),n.pos.vadd(n.old.vel).vadd(n.old.acc),n.old.vel.mult(1/e),n.old.acc.mult(2/i),o.started()||(n.old.angular.acc=n.angular.acc,n.old.angular.vel=n.angular.vel-n.old.angular.acc*e),n.old.angular.pos=n.angular.pos,n.angular.pos+=n.angular.vel*e+.5*n.old.angular.acc*i)}}})),n.renderer(\"canvas\",(function(t){if(!e)return{};var i=2*Math.PI,o=function(t,n){var i=e.createElement(t||\"div\");return n&&(i.innerHTML=n),i},r=\"#fff\",s=\"#542437\",a=\"#53777A\",l={metaEl:null,styles:{point:a,circle:{strokeStyle:a,lineWidth:1,fillStyle:a,angleIndicator:r},rectangle:{strokeStyle:s,lineWidth:1,fillStyle:s,angleIndicator:r},\"convex-polygon\":{strokeStyle:s,lineWidth:1,fillStyle:s,angleIndicator:r}},offset:{x:0,y:0}};return{init:function(i){var r=this;if(t.init.call(this,i),this.options.defaults(l,!0),this.options.onChange((function(){r.options.offset=new n.vector(r.options.offset)})),this.options(i,!0),this.hiddenCanvas=e.createElement(\"canvas\"),this.hiddenCanvas.width=this.hiddenCanvas.height=100,!this.hiddenCanvas.getContext)throw\"Canvas not supported\";this.hiddenCtx=this.hiddenCanvas.getContext(\"2d\");var s=this.el;if(\"CANVAS\"!==s.nodeName.toUpperCase()&&(s=e.createElement(\"canvas\"),this.el.appendChild(s),\"string\"==typeof this.options.el&&this.el===e.body&&(s.id=this.options.el),this.el=s),this.container=this.el.parentNode,this.ctx=s.getContext(\"2d\"),this.els={},this.options.meta){var a=this.options.metaEl||o();a.className=\"pjs-meta\",this.els.fps=o(\"span\"),this.els.ipf=o(\"span\"),a.appendChild(o(\"span\",\"fps: \")),a.appendChild(this.els.fps),a.appendChild(o(\"br\")),a.appendChild(o(\"span\",\"ipf: \")),a.appendChild(this.els.ipf),s.parentNode.insertBefore(a,s)}this._layers={},this.addLayer(\"main\",this.el),this.options.autoResize?this.resize():this.resize(this.options.width,this.options.height)},layer:function(t){return t in this._layers?this._layers[t]:null},addLayer:function(t,i,o){var r=this,s=[],a=n.util.extend({},this.options.styles),l={id:t,el:i||e.createElement(\"canvas\"),options:n.util.options({width:this.el.width,height:this.el.height,manual:!1,autoResize:!0,follow:null,offset:null,scale:1,zIndex:1})(o)};if(t in this._layers)throw'Layer \"'+t+'\" already added.';return this.el.parentNode.insertBefore(l.el,this.el),l.el.style.position=\"absolute\",l.el.style.zIndex=l.options.zIndex,l.el.className+=\" pjs-layer-\"+l.id,l.ctx=l.el.getContext(\"2d\"),l.ctx.scale(1,1),l.el.width=l.options.width,l.el.height=l.options.height,l.bodies=s,l.reset=function(t){return s=t||[],l},l.addToStack=function(t){return n.util.isArray(t)?s.push.apply(s,t):s.push(t),l},l.removeFromStack=function(t){var e,i;if(n.util.isArray(t))for(e=0,i=t.length;i>e;++e)l.removeFromStack(t[e]);else(e=n.util.indexOf(s,t))>-1&&s.splice(e,1);return l},l.render=function(t){var e,i,o=n.scratchpad(),c=o.vector().set(0,0),h=l.options.scale,u=s.length,d=r._interpolateTime,p=u||\"main\"!==l.id?s:r._world._bodies;if(l.options.manual)return o.done(),l;for(l.options.offset&&(\"center\"===l.options.offset?c.add(.5*l.el.width,.5*l.el.height).mult(1/h):c.vadd(l.options.offset).mult(1/h)),l.options.follow&&(c.vsub(l.options.follow.state.pos),c.sub(l.options.follow.state.vel.get(0)*d,l.options.follow.state.vel.get(1)*d)),!1!==t&&l.ctx.clearRect(0,0,l.el.width,l.el.height),1!==h&&(l.ctx.save(),l.ctx.scale(h,h)),i=0,u=p.length;u>i;++i)(e=p[i]).hidden||(e.view||(e.view=r.createView(e.geometry,e.styles||a[e.geometry.name])),r.drawBody(e,e.view,l.ctx,c));return 1!==h&&l.ctx.restore(),o.done(),l},this._layers[t]=l,l},removeLayer:function(t){var e=t.id?t.id:t,n=this._layers[e].el;return n!==this.el&&n.parentNode.removeChild(n),delete this._layers[e],this},resize:function(e,n){var i;for(var o in t.resize.call(this,e,n),this._layers)(i=this._layers[o]).options.autoResize&&(i.el.width=this.width,i.el.height=this.height);return this},setStyle:function(t,e){e=e||this.ctx,n.util.isObject(t)?(t.strokeStyle=t.lineWidth?t.strokeStyle:\"rgba(0,0,0,0)\",n.util.extend(e,t)):(e.fillStyle=e.strokeStyle=t,e.lineWidth=1)},drawCircle:function(t,e,n,o,r){(r=r||this.ctx).beginPath(),this.setStyle(o,r),r.arc(t,e,n,0,i,!1),r.closePath(),r.stroke(),r.fill()},drawPolygon:function(t,e,n){var i=t[0],o=i.x,r=i.y,s=t.length;(n=n||this.ctx).beginPath(),this.setStyle(e,n),n.moveTo(o,r);for(var a=1;s>a;++a)o=(i=t[a]).x,r=i.y,n.lineTo(o,r);s>2&&n.closePath(),n.stroke(),n.fill()},drawRect:function(t,e,n,i,o,r){var s=.5*n,a=.5*i;r=r||this.ctx,this.setStyle(o,r),r.beginPath(),r.rect(t-s,e-a,n,i),r.closePath(),r.stroke(),r.fill()},drawLine:function(t,e,n,i){var o=t.x,r=t.y;(i=i||this.ctx).beginPath(),this.setStyle(n,i),i.moveTo(o,r),o=e.x,r=e.y,i.lineTo(o,r),i.stroke(),i.fill()},draw:function(t,e,n,i){var o=t.name,r=+(i&&i.x),s=+(i&&i.y),a=t.aabb().hw;if(n=n||this.ctx,e=e||this.options.styles[o]||this.options.styles.circle||{},n.save(),n.translate(r,s),\"circle\"===o)this.drawCircle(0,0,t.radius,e,n);else if(\"convex-polygon\"===o)this.drawPolygon(t.vertices,e,n);else if(\"rectangle\"===o)this.drawRect(0,0,t.width,t.height,e,n);else if(\"compound\"===o)for(var l,c=0,h=t.children.length;h>c;c++)l=t.children[c],n.translate(l.pos.x,l.pos.y),n.rotate(l.angle),this.draw(l.g,e,n),n.rotate(-l.angle),n.translate(-l.pos.x,-l.pos.y);else this.drawCircle(0,0,1,e,n);return\"compound\"!==o&&e.angleIndicator&&(n.beginPath(),this.setStyle(e.angleIndicator,n),n.moveTo(0,0),n.lineTo(a,0),n.closePath(),n.stroke()),n.restore(),this},createView:function(t,e){var n,i=t.aabb(),o=i.hw+Math.abs(i.x),r=i.hh+Math.abs(i.y),s={x:o+1,y:r+1},a=this.hiddenCtx,l=this.hiddenCanvas;return(e=e||this.options.styles[name]||this.options.styles.circle||{}).src?((n=new Image).src=e.src,e.width&&(n.width=e.width),e.height&&(n.height=e.height),n):(s.x+=0|e.lineWidth,s.y+=0|e.lineWidth,l.width=2*o+2+(2*e.lineWidth|0),l.height=2*r+2+(2*e.lineWidth|0),this.draw(t,e,a,s),(n=new Image(l.width,l.height)).src=l.toDataURL(\"image/png\"),n)},drawMeta:function(t){this.els.fps.innerHTML=t.fps.toFixed(2),this.els.ipf.innerHTML=t.ipf},drawBody:function(t,e,n,i){var o,r,s,a=t.state.pos,l=t.offset,c=t.state.vel,h=this._interpolateTime||0;i=i||this.options.offset,n=n||this.ctx,o=a._[0]+i.x+c._[0]*h,r=a._[1]+i.y+c._[1]*h,s=t.state.angular.pos+t.state.angular.vel*h,n.save(),n.translate(o,r),n.rotate(s),n.translate(l._[0],l._[1]),n.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),n.restore()},render:function(t,e){for(var n in this._world.emit(\"beforeRender\",{renderer:this,meta:e}),this.options.meta&&this.drawMeta(e),this._interpolateTime=e.interpolateTime,this._layers)this._layers[n].render();return this}}})),n.renderer(\"dom\",(function(t){if(!e)return{};var n={},i=e.createElement(\"div\"),o=function(t){return t.replace(/(?:^|\\s)\\w/g,(function(t){return t.toUpperCase()}))},r=function(t){if(n[t])return n[t];for(var e,r=[\"Webkit\",\"Moz\",\"Ms\",\"O\"],s=0,a=r.length;a>s;++s)if((e=r[s]+o(t))in i.style)return n[t]=e;return e in i.style&&(n[t]=t)},s=\"pjs-\",a=\"px\",l=r(\"transform\"),c=r(\"borderRadius\"),h=function(t,n){var i=e.createElement(t||\"div\");return n&&(i.innerHTML=n),i};return{init:function(e){t.init.call(this,e);var n=this.el;if(n.style.position=\"relative\",n.style.overflow=\"hidden\",n.style[l]=\"translateZ(0)\",n.style.width=this.options.width+a,n.style.height=this.options.height+a,this.els={},e.meta){var i=h();i.className=\"pjs-meta\",this.els.fps=h(\"span\"),this.els.ipf=h(\"span\"),i.appendChild(h(\"span\",\"fps: \")),i.appendChild(this.els.fps),i.appendChild(h(\"br\")),i.appendChild(h(\"span\",\"ipf: \")),i.appendChild(this.els.ipf),n.appendChild(i)}this.options.autoResize?this.resize():this.resize(this.options.width,this.options.height)},resize:function(e,n){t.resize.call(this,e,n),this.el.style.width=this.width+a,this.el.style.height=this.height+a},pointProperties:function(t){t.style.width=\"2px\",t.style.height=\"2px\",t.style.marginLeft=\"-1px\",t.style.marginTop=\"-1px\",t.style[c]=\"50%\"},circleProperties:function(t,e){var n=e.aabb();t.style.width=2*n.hw+a,t.style.height=2*n.hh+a,t.style.marginLeft=-n.hw+a,t.style.marginTop=-n.hh+a,t.style[c]=\"50%\"},rectangleProperties:function(t,e){var n=e.aabb();t.style.width=2*n.hw+a,t.style.height=2*n.hh+a,t.style.marginLeft=-n.hw+a,t.style.marginTop=-n.hh+a},createView:function(t){var e,n=h(),i=t.name+\"Properties\";if(n.className=s+t.name,n.style.position=\"absolute\",n.style.top=\"0px\",n.style.left=\"0px\",\"compound\"===t.name)for(var o,r=0,a=t.children.length;a>r;r++)o=t.children[r],(e=h()).className=s+t.name+\" \"+s+\"child\",e.style.position=\"absolute\",e.style.top=\"0px\",e.style.left=\"0px\",this[o.g.name+\"Properties\"]&&this[o.g.name+\"Properties\"](e,o.g),e.style[l]=\"translate(\"+o.pos._[0]+\"px,\"+o.pos._[1]+\"px) rotate(\"+o.angle+\"rad)\",n.appendChild(e);else this[i]&&this[i](n,t);return this.el.appendChild(n),n},connect:function(t){t.on(\"add:body\",this.attach,this),t.on(\"remove:body\",this.detach,this)},disconnect:function(t){t.off(\"add:body\",this.attach,this),t.off(\"remove:body\",this.detach,this)},detach:function(t){var e=t.nodeType&&t||t.body&&t.body.view,n=e&&e.parentNode;return e&&n&&n.removeChild(e),this},attach:function(t){var e=t.nodeType&&t||t.body&&t.body.view;return e&&this.el.appendChild(e),this},drawMeta:function(t){this.els.fps.innerHTML=t.fps.toFixed(2),this.els.ipf.innerHTML=t.ipf},drawBody:function(t,e){var n,i,o,r=t.state.pos,s=t.state.vel,a=t.offset,c=this._interpolateTime;n=r._[0]+s._[0]*c,i=r._[1]+s._[1]*c,o=t.state.angular.pos+t.state.angular.vel*c,e.style[l]=\"translate(\"+n+\"px,\"+i+\"px) rotate(\"+o+\"rad) translate(\"+a._[0]+\"px,\"+a._[1]+\"px)\"}}})),n.renderer(\"pixi\",(function(i){if(!e)return{};var o=(Math.PI,{white:\"0xFFFFFF\",violet:\"0x542437\",blue:\"0x53777A\"}),r={font:\"18px monospace\",fill:\"black\",align:\"left\"},s={metaEl:null,offset:{x:0,y:0},styles:{color:!1,point:o.blue,circle:{strokeStyle:o.blue,lineWidth:1,fillStyle:o.blue,angleIndicator:o.white,fillAlpha:1,strokeAlpha:1,alpha:1},rectangle:{strokeStyle:o.violet,lineWidth:1,fillStyle:o.violet,angleIndicator:o.white,fillAlpha:1,strokeAlpha:1,alpha:1},\"convex-polygon\":{strokeStyle:o.violet,lineWidth:1,fillStyle:o.violet,angleIndicator:o.white,fillAlpha:1,strokeAlpha:1,alpha:1}}};return{init:function(o){var r,a,l=this;if(\"undefined\"==typeof PIXI)throw\"PIXI not present - cannot continue\";i.init.call(this,o),this.options.defaults(s,!0),this.options.onChange((function(){l.options.offset=new n.vector(l.options.offset)})),this.options(o,!0),a=!this.options.styles.color||\"transparent\"===this.options.styles.color,this.stage=new PIXI.Stage(this.options.styles.color),this.meta={},r=this.el&&\"CANVAS\"===this.el.nodeName?r:null,this.renderer=new PIXI.autoDetectRenderer(this.options.width,this.options.height,{view:r,transparent:a,resolution:t.devicePixelRatio||1}),r||(this.el=this.el||e.body,this.el.appendChild(this.renderer.view)),this.options.autoResize?this.resize():this.resize(this.options.width,this.options.height)},resize:function(t,e){i.resize.call(this,t,e),this.renderer.resize(this.width,this.height)},connect:function(t){t.on(\"add:body\",this.attach,this),t.on(\"remove:body\",this.detach,this)},disconnect:function(t){t.off(\"add:body\",this.attach,this),t.off(\"remove:body\",this.detach,this)},detach:function(t){var e=t instanceof PIXI.Graphics&&t||t.body&&t.body.view;return e&&this.stage.removeChild(e),this},attach:function(t){var e=t instanceof PIXI.Graphics&&t||t.body&&t.body.view;return e&&this.stage.addChild(e),this},loadSpriteSheets:function(t,e){if(!n.util.isArray(t))throw\"Spritesheets must be defined in arrays\";var i=this,o=new PIXI.AssetLoader(t);return o.load(),o.on(\"onComplete\",(function(){i.assetsLoaded=!0,e()})),i},drawBody:function(t,e){var n,i,o,r=t.state.pos,s=t.state.vel,a=t.offset,l=this._interpolateTime||0;n=r._[0]+s._[0]*l,i=r._[1]+s._[1]*l,o=t.state.angular.pos+t.state.angular.vel*l,e.position.set(n,i),e.pivot.set(-a._[0],-a._[1]),e.rotation=o},render:function(t,e){i.render.call(this,t,e),this.renderer.render(this.stage)},setStyles:function(t,e){return n.util.isObject(e)?(e.fillStyle&&\"transparent\"!==e.fillStyle?(t.beginFill(e.fillStyle),t.fillAlpha=void 0!==e.fillAlpha?e.fillAlpha:1):(t.beginFill(),t.fillAlpha=0),t.lineStyle(e.lineWidth||0,e.strokeStyle,void 0!==e.strokeAlpha?e.strokeAlpha:1),t.alpha=void 0!==e.alpha?e.alpha:1):(e&&\"transparent\"!==e?t.beginFill(e):(t.beginFill(),t.fillAlpha=0),t.lineStyle(0)),t},createCircle:function(t,e,n,i){var o=new PIXI.Graphics;return this.setStyles(o,i),o.drawCircle(t,e,n),o.endFill(),o},createRect:function(t,e,n,i,o){var r=new PIXI.Graphics;return this.setStyles(r,o),r.drawRect(t,e,n,i),r.endFill(),r},createPolygon:function(t,e){var n=t[0],i=n.x,o=n.y,r=t.length,s={x:i,y:o},a=new PIXI.Graphics;this.setStyles(a,e),a.moveTo(i,o);for(var l=1;r>l;++l)i=(n=t[l]).x,o=n.y,a.lineTo(i,o);return r>2&&a.lineTo(s.x,s.y),a.endFill(),a},createLine:function(t,e,n){var i=t.x,o=t.y,r=new PIXI.Graphics;return this.setStyles(r,n),r.moveTo(i,o),i=e.x,o=e.y,r.lineTo(i,o),r.endFill(),r},createView:function(t,e,n){var i=null,o=t.aabb(),r=o.hw+Math.abs(o.x),s=(o.hh,Math.abs(o.y),t.name);if(n=n||this.stage,(e=e||this.options.styles[s]||this.options.styles.circle||{}).src)return(i=PIXI.Sprite.fromImage(e.src)).anchor.set(.5,.5),e.anchor&&(i.anchor.x=e.anchor.x,i.anchor.y=e.anchor.y),e.width&&(i.width=e.width),e.height&&(i.height=e.height),n.addChild(i),i;if(\"circle\"===s)i=this.createCircle(0,0,t.radius,e);else if(\"convex-polygon\"===s)i=this.createPolygon(t.vertices,e);else if(\"rectangle\"===s)i=this.createRect(-t.width/2,-t.height/2,t.width,t.height,e);else if(\"compound\"===s){i=new PIXI.Graphics;for(var a,l,c=0,h=t.children.length;h>c;c++)a=t.children[c],(l=this.createView(a.g,e,i)).position.set(a.pos.x,a.pos.y),l.rotation=a.angle}else i=this.createCircle(0,0,1,e);return\"compound\"!==s&&e.angleIndicator&&\"transparent\"!==e.angleIndicator&&(i.lineStyle(e.lineWidth,e.angleIndicator),i.moveTo(0,0),i.lineTo(r,0)),\"compound\"!==s&&(i.cacheAsBitmap=!0),n.addChild(i),i},drawMeta:function(t){this.meta.loaded?(this.meta.fps.setText(\"FPS: \"+t.fps.toFixed(2)),this.meta.ipf.setText(\"IPF: \"+t.ipf)):(this.meta.fps=new PIXI.Text(\"FPS: \"+t.fps.toFixed(2),r),this.meta.fps.position.x=15,this.meta.fps.position.y=5,this.meta.ipf=new PIXI.Text(\"IPF: \"+t.ipf,r),this.meta.ipf.position.x=15,this.meta.ipf.position.y=30,this.stage.addChild(this.meta.fps),this.stage.addChild(this.meta.ipf),this.meta.loaded=!0)},createDisplay:function(t,e){var n=null,i=null;switch(t){case\"sprite\":return i=PIXI.Texture.fromImage(e.texture),n=new PIXI.Sprite(i),e.anchor&&(n.anchor.x=e.anchor.x,n.anchor.y=e.anchor.y),e.container?e.container.addChild(n):this.stage.addChild(n),n;case\"movieclip\":if(!this.assetsLoaded)throw\"No assets have been loaded. Use loadSpritesheet() first\";for(var o=[],r=0;r<e.frames.length;r++)i=PIXI.Texture.fromFrame(e.frames[r]),o.push(i);return n=new PIXI.MovieClip(o),e.anchor&&(n.anchor.x=e.anchor.x,n.anchor.y=e.anchor.y),e.container?e.container.addChild(n):this.stage.addChild(n),n;default:throw\"Invalid PIXI.DisplayObject passed\"}},centerAnchor:function(t){null!==t&&(t.anchor.x=.5,t.anchor.y=.5)}}})),n}.call(i)},function(t,e,n){var i,o=n(2);console.log(\"gameframe.js\"),(()=>{let e,n,r,s,a,l,c,h,u,d,p=!1,f={},v={},m=[],g={},y=0,b=0,_=0,w=0,x={},P={38:\"up\",40:\"down\",37:\"left\",39:\"right\"},C=(t,e)=>isNaN(t)?e:t,A=o.aabb(0,0,window.innerWidth,window.innerHeight),k=o.behavior(\"edge-collision-detection\",{aabb:A,restitution:0,cof:0}),T=function(){this.cache={}};T.prototype.key=(t,e)=>({rect:[t.width,t.height,e].toString(),circle:[t.geometry.radius,e].toString()}[t.gf_type]),T.prototype.attempt=function(t,e){return this.cache[this.key(t,e)]},T.prototype.set=function(t,e){this.cache[t]=e,i.prototype.external_cache(t,e)};let I,B=new T,M={circle:function(t){return o.body(\"circle\",{name:t.classList.contains(\"movable\")?\"movable\":\"\",treatment:t.classList.contains(\"static\")?\"static\":\"dynamic\",x:0|(t.attributes.cx||t.attributes.x||0).value,y:0|(t.attributes.cy||t.attributes.y||0).value,radius:0|(t.attributes.r||0).value,vy:(t.attributes.vy||0).value,vx:(t.attributes.vx||0).value,restitution:C((t.attributes.bounce||0).value,.5),cof:C((t.attributes.friction||0).value,.5),impulse:!t.classList.contains(\"no-impulse\")})},rect:function(t){return o.body(\"rectangle\",{name:t.classList.contains(\"movable\")?\"movable\":\"\",treatment:t.classList.contains(\"static\")?\"static\":\"dynamic\",width:0|(t.attributes.width||0).value,height:0|(t.attributes.height||0).value,x:0|(t.attributes.x||0).value,y:0|(t.attributes.y||0).value,vy:(t.attributes.vy||0).value,vx:(t.attributes.vx||0).value,restitution:C((t.attributes.bounce||0).value,.5),cof:C((t.attributes.friction||0).value,.5),impulse:!t.classList.contains(\"no-impulse\")})},g:function(t){let e=[];for(let n=0;n<t.children.length;n++)e[n]=z(t.children[n]);if(0!=e.length)return o.body(\"compound\",{name:\"movable\"in t.classList?\"movable\":\"\",treatment:t.classList.contains(\"static\")?\"static\":\"dynamic\",x:0|(t.attributes.x||0).value,y:0|(t.attributes.y||0).value,children:e})}},S={rect:(t,e,n)=>function(){l.width=t.width,l.height=t.height,c.drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),t.view.src=l.toDataURL(\"image/png\"),B.set(B.key(t,n),t.view.src)},circle:(t,e,n)=>function(){let i=t.geometry.radius;l.width=2*i,l.height=2*i,c.save(),c.arc(i,i,i,0,2*Math.PI,!1),c.clip(),c.drawImage(e,0,0,e.width,e.height,0,0,2*i,2*i),t.view.src=l.toDataURL(\"image/png\"),B.set(B.key(t,n),t.view.src)}},L=function(t,e){return[t,e].sort().join()},j=function(t){return t in P?P[t]:String.fromCharCode(t)},O=function(){let t=document.getElementById(\"viewport\");if(!t)return;let e=window.innerHeight,n=e*(t.width/t.height);t.style.width=n+\"px\",t.style.height=e+\"px\",t.style.left=(window.innerWidth-n)/2+\"px\",console.log(\"yoresize\"),p&&i.prototype.boundaries&&(A=o.aabb(0,0,d.width,d.height),k.setAABB(A))},F=function(){e=document.getElementById(\"game\")||{attributes:{}},n=document.getElementById(\"templates\"),r=document.createElement(\"div\"),s=document.createElement(\"div\"),a=document.createElement(\"style\"),l=document.createElement(\"canvas\"),c=l.getContext(\"2d\"),h=e.children,r.id=\"scoreboard\",document.body.appendChild(r);let t=(e.attributes.img||0).value;t&&(t=i.prototype.cache_proxy(t,\"background\"),a.innerHTML=\"#viewport{background-image:url('\"+t+\"');background-size: cover;}\",document.body.appendChild(a)),i.prototype.modal&&(console.log(\"gameframe.js prot?\"),s.id=\"modal\",s.innerHTML='\\n            <div id=\"box\">\\n                <h1 id=\"modal-title\"></h1>\\n                <div id=\"comment\"></div>\\n                <button type=\"button\"\\n                        id=\"button\"\\n                        onclick=\"GameFrame.GameFrame.prototype.init()\"\\n                        class=\"btn btn-primary\">Play game</button>\\n            </div>\\n            <div id=\"backdrop\"></div>\\n        ',document.body.appendChild(s),document.getElementById(\"modal-title\").innerHTML=i.prototype.name,document.getElementById(\"comment\").innerHTML=i.prototype.instructions)},z=function(t){let e=t.nodeName.toLowerCase(),n=M[e];if(null==n)return void console.warn(\"Woops, element \"+e+\" not known.\");let o=n(t),r=(t.attributes.img||0).value;return r&&S[e]&&(o.gf_type=e,i.prototype.image(o,r)),o},E=function(t){let e=z(t);if(e){let n=[];t.id||(t.id=\"generated_\"+b,b+=1),g[\"#\"+t.id]=e,n[n.length]=\"#\"+t.id;for(let i=0;i<t.classList.length;i++){let o=\".\"+t.classList[i];o in g||(g[o]=new Set),g[o].add(e),n[n.length]=o}e.ids=n,u.add(e)}return e},q=function(t){if(x[t]=!0,t in v)for(let e in v[t])v[t][e](g[e],g)};document.addEventListener(\"keydown\",(function(t){let e=j(t.keyCode);q(e)})),document.addEventListener(\"keyup\",(function(t){x[j(t.keyCode)]=!1})),window.addEventListener(\"resize\",O,!0),(i=function(t,e){i.prototype.name=t.name||\"GameFrame Game\",i.prototype.instructions=t.instructions||\"instructions\",i.prototype.boundaries=!(\"boundaries\"in t)||t.boundaries,i.prototype.impulse=!(\"impulse\"in t)||t.impulse,i.prototype.gravity=\"gravity\"in t&&t.gravity,i.prototype.debug=\"debug\"in t&&t.debug,i.prototype.modal=!(\"modal\"in t)||t.modal,i.prototype.external_cache=\"external_cache\"in t?t.external_cache:function(){},i.prototype.cache_proxy=\"cache_proxy\"in t?t.cache_proxy:function(t){return t},i.prototype.set_score=\"set_score\"in t?t.set_score:function(t){localStorage.setItem(\"highscore\",t)},i.prototype.get_score=\"get_score\"in t?t.get_score:function(t){return 0|localStorage.highscore},i.prototype.set_score(i.prototype.get_score()),i.prototype.game=e,console.log(\"gameframe constructor\"),F()}).prototype.collision=function(t,e,n){let i=L(t,e);f[i]=n},i.prototype.remove=function(t){u.removeBody(t),delete g[t.ids[0]];for(let e=1;e<t.ids.length;e++)g[t.ids[e]].delete(t)},i.prototype.registerKeys=function(t,e){for(let n in e)n in v||(v[n]={}),v[n][t]=e[n],!I&&Object.values(P).indexOf(n)+1&&\"undefined\"!=typeof nipplejs&&(I=nipplejs.create({zone:document.body,color:\"blue\"}),I.on(\"dir:up plain:up dir:left plain:left dir:down plain:down dir:right plain:right\",(function(t,n){let i=n.direction.angle;Object.values(P).forEach(t=>{e[t]=t==i}),q(i)})))},i.prototype.registerLoops=function(t){m[m.length]=t},i.prototype.template=function(t,e,i){let o=n.querySelector(t).cloneNode(!0);return o.setAttribute(\"x\",0|(e||o.attributes.x)),o.setAttribute(\"y\",0|(i||o.attributes.y)),E(o)},i.prototype.image=function(t,e){let n=t.gf_type;if(!n)return;let o,r=new Image;t.view=new Image,(o=B.attempt(t,e))?t.view.src=o:(r.setAttribute(\"crossOrigin\",\"anonymous\"),r.onload=S[n](t,r,e),r.src=i.prototype.cache_proxy(e,B.key(t,e)))},i.prototype.gameOver=function(){s.classList=\"\",document.getElementById(\"viewport\").remove(),document.getElementById(\"modal-title\").innerHTML=\"Gameover\";let t=document.getElementById(\"comment\");t.innerHTML=\"Score:\"+y,t.innerHTML+=\"<br/> Highscore:\"+i.prototype.get_score(),I&&(I.destroy(),I=void 0),o.util.ticker.stop(),u.destroy()},i.prototype.score=function(t){y+=t||0,y>i.prototype.get_score()&&i.prototype.set_score(y),r.innerHTML=\"Score: \"+y},i.prototype.init=function(){console.log(\"init1\"),s.classList=\"hidden\",i.prototype.debug||(window.scrollTo(0,1),document.body.webkitRequestFullScreen&&document.body.webkitRequestFullScreen()),y=0,_=0,tp=0,f={},v={},m=[],g={},console.log(\"init2\"),console.log(\"yoyoyoyo\"),o({sleepDisabled:!0},(function(t){u=t,k=o.behavior(\"edge-collision-detection\",{aabb:A,restitution:C((e.attributes.bounce||0).value,.5),cof:C((e.attributes.friction||0).value,.5)}),console.log(\"yoyo111\");for(let t=0;t<h.length;t++)E(h[t]);d=o.renderer(\"canvas\",{el:\"viewport\",meta:!1,width:4e3,height:2e3,autoResize:!1}),u.add(d),u.on(\"collisions:detected\",(function(t){let e;for(let n=t.collisions.length-1;n>=0;n--)if(e=t.collisions[n],e.bodyA.ids&&e.bodyB.ids)for(let t=0;t<e.bodyA.ids.length;t++)for(let n=0;n<e.bodyB.ids.length;n++){let i=L(e.bodyA.ids[t],e.bodyB.ids[n]);i in f&&(datum={},datum[e.bodyA.ids[t]]=e.bodyA,datum[e.bodyB.ids[n]]=e.bodyB,f[i](datum,g))}})),u.on(\"interact:click\",(function(t){if(\"click\"in v)for(let e in v.click)v.click[e](g[e],g,t)})),u.add([o.behavior(\"body-collision-detection\",{checkAll:!1}),o.behavior(\"sweep-prune\"),o.behavior(\"interactive-custom\",{el:d.el}).applyTo(u.find({name:\"movable\"}))]),i.prototype.boundaries&&u.add(k),i.prototype.impulse&&u.add(o.behavior(\"body-impulse-response\").applyTo(u.find({impulse:!0}))),i.prototype.gravity&&u.add(o.behavior(\"constant-acceleration\")),u.on(\"step\",(function(){let t=_-w;for(let e=0;e<m.length;e++)m[e](g,t);u.render()})),p||o.util.ticker.on((function(t){w=_,_=t,0==w&&(w=_),u.step(t)})),o.util.ticker.start(),p=!0})),console.log(\"init3\"),i.prototype.score(0),console.log(\"init4\"),i.prototype.game(this),conosole.log(\"init5\"),O()},t.exports.GameFrame=i})(),console.log(\"end gameframe.js\"),console.log(window)},,,,,,,function(t,e,n){\"use strict\";n.r(e);var i=n(2),o=n.n(i),r=n(3),s=n.n(r);n(11),window.Physics=o.a,n(13),window.GameFrame=s.a,n(14)},function(t,e,n){var i=n(0),o=n(12);\"string\"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,\"\"]]);var r={insert:\"head\",singleton:!1},s=(i(o,r),o.locals?o.locals:{});t.exports=s},function(t,e,n){(e=n(1)(!1)).push([t.i,\".CodeMirror {\\n    height: auto;\\n}\\n\\n#QR, .fullscreenbutton {\\n    float: right;\\n}\\n\\n.CodeMirror-selected {\\n    background: blue;\\n     \\n}\\n\\niframe {\\n    display: none;\\n}\\n\\n.iframe-fullscreen {\\n    width: 100%;\\n    height: 100%;\\n}\\n\\n#frameBody {\\n    overflow: hidden !important;\\n}\\n\\n.active iframe {\\n    display: block;\\n/*    width: 100%;\\n*/    width: -moz-available;      /* WebKit-based browsers will ignore this. */\\n    width: -webkit-fill-available;  /* Mozilla-based browsers will ignore this. */\\n    /*width: fill-available;*/\\n}\\n\\n.tab-content {}\\n\\n.list-group {\\n    margin-bottom: 10px;\\n    overflow: scroll;\\n    -webkit-overflow-scrolling: touch;\\n}\\n\\n.addImageButton {\\n  float: right;\\n}\\n\\n.cleancode {\\n  margin: 5px;\\n}\\n\\n#qrcode img {\\n    margin: 0 auto;\\n}\\n\",\"\"]),t.exports=e},function(t,e){Physics.behavior(\"interactive-custom\",(function(t){/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());if(!document)return{};let e={el:null,moveThrottle:10,minVel:{x:-5,y:-5},maxVel:{x:5,y:5}},n=function(t){let e=function(t){let e=0,n=0;if(t.offsetParent)do{e+=t.offsetLeft,n+=t.offsetTop}while(t=t.offsetParent);return{left:e,top:n}}(t.target),n=t.changedTouches&&t.changedTouches[0]||t,i=n.pageX-e.left,o=n.pageY-e.top;return i*=768/window.innerHeight,o*=768/window.innerHeight,{x:i,y:o}};return{init:function(i){let o,r,s=this;if(t.init.call(this),this.options.defaults(e),this.options(i),this.mousePos=new Physics.vector,this.mousePosOld=new Physics.vector,this.offset=new Physics.vector,this.el=\"string\"==typeof this.options.el?document.getElementById(this.options.el):this.options.el,!this.el)throw\"No DOM element specified\";let a=Physics.util.throttle((function(t){let e=n(t);s.body&&(r=Physics.util.ticker.now(),s.mousePosOld.clone(s.mousePos),s.mousePos.set(e.x,e.y),e.body=s.body),s._world.emit(\"interact:move\",e)}),s.options.moveThrottle);this.el.addEventListener(\"mousedown\",(function(t){let e,i=n(t);r=Physics.util.ticker.now(),s._world&&(e=s._world.findOne({$at:new Physics.vector(i.x,i.y),$in:s.getTargets()}),e?(o=e.treatment,e.treatment=\"kinematic\",e.state.vel.zero(),e.state.angular.vel=0,s.body=e,s.mousePos.clone(i),s.mousePosOld.clone(i),s.offset.clone(i).vsub(e.state.pos),i.body=e,s._world.emit(\"interact:grab\",i)):\"mousedown\"==t.type&&(e=s._world.findOne({$at:new Physics.vector(i.x,i.y)}),e&&(i.body=e,s._world.emit(\"interact:poke\",i)),s._world.emit(\"interact:click\",i)))})),this.el.addEventListener(\"mousemove\",a),this.el.addEventListener(\"mouseup\",(function(t){let e=n(t),i=Math.max(Physics.util.ticker.now()-r,s.options.moveThrottle);s.mousePos.set(e.x,e.y),s.body&&(s.body.treatment=o,s.body.state.vel.clone(s.mousePos).vsub(s.mousePosOld).mult(1/i),s.body.state.vel.clamp(s.options.minVel,s.options.maxVel),s.body=!1),s._world&&s._world.emit(\"interact:release\",e)}))},connect:function(t){t.on(\"integrate:positions\",this.behave,this)},disconnect:function(t){t.off(\"integrate:positions\",this.behave)},behave:function(t){let e,n=this,i=Math.max(t.dt,n.options.moveThrottle);n.body&&(e=n.body.state,e.vel.clone(n.mousePos).vsub(n.offset).vsub(e.pos).mult(1/i))}}}))},function(module,exports){var code=\"console.error('Nothing to run!!')\";let image_lookup={};console.log(\"frame.js\"),console.log(window);let meta={debug:!0,external_cache:function(t,e){},cache_proxy:function(t,e){let n=t.split(\"gf://\")[1];return n in image_lookup&&(t=image_lookup[n]),\"https://api.carolinaignites.org/cors/\"+t}};(()=>{let C={__on:{},addEventListener:function(t,e){return this.__on[t]=(this.__on[t]||[]).concat(e),this},dispatchEvent:function(t,e){this.__on[t]=this.__on[t]||[];for(var n=0,i=this.__on[t].length;n<i;n++)this.__on[t][n].call(this,e);return this},log:function(){let t=[];for(let e=0,n=arguments.length;e<n;e++){let n=(new Error).stack.split(\"\\n\")[2].split(\":\"),i=0|n[n.length-2];t.push(arguments[e].toString()+\" (line \"+i+\")\")}this.dispatchEvent(\"log\",t.join(\"\\n\"))},error:function(){let t=[];for(let e=0,n=arguments.length;e<n-2;e++){let n=arguments[e].message;n+=arguments[e].stack.replace(/\\([^:]*:[^:]*:/g,\"(line \"),t.push(n)}this.dispatchEvent(\"error\",t)}};C.debug=C.info=C.log,window.console=C;let query=window.location.search.split(\"?q=\"),lookup=window.location.search.split(\"?l=\");var data={meta:meta};let parse=function(t){let e=window.atob(t),n=document.querySelector(\"#container\");data=JSON.parse(e),meta=Object.assign({},data.meta,meta),code=window.atob(data.code),image_lookup=JSON.parse(window.atob(data.images)),n.innerHTML=window.atob(data.html)};lookup.length>1?$.ajax({url:\"https://api.carolinaignites.org/\"+lookup[1],dataType:\"json\",async:!1,success:t=>{t.valid?parse(t.data):parse(query[1])}}).fail(()=>parse(query[1])):query.length>1&&parse(query[1]),new GameFrame.GameFrame(meta,(function(gf){let collision=gf.collision,gameOver=gf.gameOver,score=gf.score,remove=gf.remove,registerKeys=gf.registerKeys,registerLoops=gf.registerLoops,template=gf.template;try{eval(code)}catch(t){console.log(\"yoyoyo\");var err=t.constructor(t.message);let e=t.stack.split(\"\\n\")[1].split(\":\");throw err.lineNumber=e[e.length-2],console.error(err),err}}))})()}]);","extractedComments":[]}